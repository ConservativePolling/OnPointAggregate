<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Modern Chronicle</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700;800;900&family=Libre+Franklin:wght@300;400;500;600;700;800&display=swap');
        
        body {
            font-family: 'Libre Franklin', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .font-serif {
            font-family: 'Crimson Pro', Georgia, 'Times New Roman', serif;
            letter-spacing: -0.015em;
        }
        
        .article-card {
            transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .article-card:hover {
            transform: translateY(-2px);
        }
        
        .live-indicator {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .smooth-scroll {
            scroll-behavior: smooth;
        }
        
        .category-pill {
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .image-overlay {
            transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .article-card:hover .image-overlay {
            opacity: 1;
        }

        .prose {
            font-family: 'Crimson Pro', Georgia, serif;
            font-size: 1.125rem;
            line-height: 1.8;
        }

        .prose h2 {
            font-family: 'Crimson Pro', Georgia, serif;
            font-weight: 700;
            line-height: 1.2;
        }

        .prose p {
            margin-bottom: 1.5rem;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Initialize Netlify Identity
        if (typeof netlifyIdentity !== 'undefined') {
            netlifyIdentity.on('init', user => {
                console.log('Netlify Identity initialized', user);
            });

            netlifyIdentity.on('login', user => {
                console.log('User logged in', user);
                window.location.reload();
            });

            netlifyIdentity.on('logout', () => {
                console.log('User logged out');
                window.location.reload();
            });
        }

        // Helper function to calculate relative time
        function getRelativeTime(timestamp) {
            const now = new Date();
            const past = new Date(timestamp);
            const diffMs = now - past;
            const diffSecs = Math.floor(diffMs / 1000);
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);

            if (diffSecs < 30) return "Just now";
            if (diffMins < 1) return `${diffSecs}s ago`;
            if (diffMins < 60) return `${diffMins}m ago`;
            if (diffHours < 24) return `${diffHours}h ago`;
            return `${diffDays}d ago`;
        }

        const articles = [
            {
                id: 1,
                title: "LESTER TELLEZ CHARGED",
                excerpt: "Former UCF student body presidential candidate and creator of Five Nights at Freddy's fan game 'Grizzly's' arrested on FIU campus for battery on persons with disabilities. Trial set for December 8.",
                category: "Legal",
                author: "The OnPoint Articles Team",
                date: "2025-10-13",
                readTime: "8 min read",
                image: "GiaxDOJb0AAj_4v.jpeg",
                featured: true,
                breaking: true,
                liveUpdates: [
                    { time: "18:30", text: "Sources indicate Lester Tellez is set to plead 'Not Guilty' at upcoming arraignment" },
                    { time: "16:45", text: "Trial scheduled for December 8, 2025, in Miami-Dade County Circuit Court before Judge Andrea Ricker Wolfson" },
                    { time: "15:20", text: "Tellez released on $5,000 bond shortly after booking at Turner Guilford Knight Correctional Center" },
                    { time: "14:15", text: "GameJolt gaming platform bans developer's account following arrest, removing years of game development work" },
                    { time: "11:30", text: "Court records confirm two third-degree felony charges under Florida Statute § 784.085 filed in Case F25-022112" },
                    { time: "09:45", text: "FIU Campus Police arrest Lester Gabriel Tellez, 20, on FIU campus for battery on persons with mental or physical disabilities" }
                ],
                reporterComments: [
                    { timestamp: "2025-10-13T18:30:00", text: "<span class='font-bold'>UPDATE:</span> Sources close to the case indicate that Lester Tellez is expected to enter a plea of \"Not Guilty\" at his upcoming arraignment. This is a common initial plea in felony cases, allowing the defense time to review evidence and potentially negotiate with prosecutors. The Not Guilty plea means the case will proceed toward the December 8 trial date unless a plea agreement is reached beforehand.", highlighted: false },
                    { timestamp: "2025-10-13T14:00:00", text: "The trespassing element adds a significant dimension to this case. Tellez was arrested on FIU campus despite being previously banned, which demonstrates both the seriousness of the university's prior concerns and his decision to violate that ban. This could be viewed unfavorably by prosecutors and the court.", highlighted: false },
                    { timestamp: "2025-10-13T13:00:00", text: "With trial scheduled for December 8, this case is moving relatively quickly through the court system. The December trial date suggests that prosecutors believe they have sufficient evidence to proceed. Judge Andrea Ricker Wolfson is known for her fair but thorough approach to criminal cases in Miami-Dade.", highlighted: false },
                    { timestamp: "2025-10-13T12:00:00", text: "This case intersects several communities—gaming, political commentary, and university politics. Tellez's history of campus bans and his disqualification from the UCF student body presidential race for bribery suggests a pattern of boundary violations that prosecutors may highlight during trial proceedings.", highlighted: false }
                ]
            }
        ];

        const liveUpdates = [
            { id: 1, text: "Sources indicate Tellez set to plead 'Not Guilty' at upcoming arraignment", time: "Just now" },
            { id: 2, text: "Trial set for December 8, 2025, before Judge Andrea Ricker Wolfson", time: "2h ago" },
            { id: 3, text: "Former UCF presidential candidate arrested on FIU campus while trespassing", time: "4h ago" },
            { id: 4, text: "Tellez released on $5,000 bond; faces up to 10 years if convicted", time: "6h ago" }
        ];

        const categories = ["All", "Legal", "Business", "Technology", "Science", "Health", "Politics", "Design"];

        function App() {
            const [darkMode, setDarkMode] = useState(false);
            const [selectedArticle, setSelectedArticle] = useState(null);
            const [selectedCategory, setSelectedCategory] = useState("All");
            const [scrolled, setScrolled] = useState(false);
            const [user, setUser] = useState(null);
            const [showAccountModal, setShowAccountModal] = useState(false);
            const [savedArticles, setSavedArticles] = useState([]);
            const [showUserMenu, setShowUserMenu] = useState(false);
            const [showLoginModal, setShowLoginModal] = useState(false);
            const [showTOSModal, setShowTOSModal] = useState(false);
            const [tosAccepted, setTosAccepted] = useState(false);
            const [showUsernameModal, setShowUsernameModal] = useState(false);
            const [username, setUsername] = useState('');
            const [tempUsername, setTempUsername] = useState('');
            const [authMode, setAuthMode] = useState('signin'); // 'signin' or 'signup'
            const [authEmail, setAuthEmail] = useState('');
            const [authPassword, setAuthPassword] = useState('');
            const [authName, setAuthName] = useState('');
            const [authError, setAuthError] = useState('');
            const [authLoading, setAuthLoading] = useState(false);

            useEffect(() => {
                const handleScroll = () => setScrolled(window.scrollY > 50);
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);

            useEffect(() => {
                // Check for existing user on mount
                if (typeof netlifyIdentity !== 'undefined') {
                    const currentUser = netlifyIdentity.currentUser();
                    setUser(currentUser);

                    // Load user's saved articles
                    if (currentUser) {
                        loadSavedArticles();
                        checkUsername(currentUser);
                    }

                    // Listen for login events
                    netlifyIdentity.on('login', (loggedInUser) => {
                        setUser(loggedInUser);
                        checkUsername(loggedInUser);
                    });

                    netlifyIdentity.on('logout', () => {
                        setUser(null);
                        setUsername('');
                        localStorage.removeItem('username');
                    });
                }
            }, []);

            const checkUsername = (currentUser) => {
                if (!currentUser) return;

                // Try to load username from localStorage
                const storedUsername = localStorage.getItem(`username_${currentUser.email}`);
                if (storedUsername) {
                    setUsername(storedUsername);
                } else {
                    // No username set, show modal
                    setShowUsernameModal(true);
                }
            };

            const loadSavedArticles = async () => {
                // Load from localStorage for now, can be backend later
                const saved = localStorage.getItem('savedArticles');
                if (saved) {
                    setSavedArticles(JSON.parse(saved));
                }
            };

            const toggleSaveArticle = (articleId) => {
                let updated;
                if (savedArticles.includes(articleId)) {
                    updated = savedArticles.filter(id => id !== articleId);
                } else {
                    updated = [...savedArticles, articleId];
                }
                setSavedArticles(updated);
                localStorage.setItem('savedArticles', JSON.stringify(updated));
            };

            const openAccountModal = () => {
                if (user) {
                    setShowAccountModal(true);
                } else {
                    setShowLoginModal(true);
                }
            };

            const openAuthModal = (mode = 'signin') => {
                setAuthMode(mode);
                setAuthEmail('');
                setAuthPassword('');
                setAuthName('');
                setAuthError('');
                setShowLoginModal(true);
            };

            const handleAuthSubmit = async (e) => {
                e.preventDefault();
                setAuthError('');
                setAuthLoading(true);

                // For now, just open Netlify Identity widget
                // Custom form is for UI only, actual auth handled by Netlify
                try {
                    if (typeof netlifyIdentity === 'undefined') {
                        throw new Error('Authentication system not loaded. Please refresh the page.');
                    }

                    console.log('🔐 Opening Netlify Identity widget in mode:', authMode);

                    // Close our custom modal
                    setShowLoginModal(false);

                    // Small delay for smooth transition
                    setTimeout(() => {
                        if (authMode === 'signup') {
                            netlifyIdentity.open('signup');
                        } else {
                            netlifyIdentity.open('login');
                        }
                    }, 100);

                } catch (error) {
                    console.error('Auth error:', error);
                    setAuthError(error.message || 'Authentication failed. Please try again.');
                    setAuthLoading(false);
                }
            };

            const openTOS = () => {
                setShowTOSModal(true);
            };

            const saveUsername = () => {
                if (!tempUsername.trim()) {
                    alert('Please enter a username');
                    return;
                }

                if (tempUsername.length < 3) {
                    alert('Username must be at least 3 characters');
                    return;
                }

                if (tempUsername.length > 20) {
                    alert('Username must be 20 characters or less');
                    return;
                }

                // Check for invalid characters
                if (!/^[a-zA-Z0-9_-]+$/.test(tempUsername)) {
                    alert('Username can only contain letters, numbers, underscores, and hyphens');
                    return;
                }

                // Save to localStorage
                localStorage.setItem(`username_${user.email}`, tempUsername);
                setUsername(tempUsername);
                setShowUsernameModal(false);
                setTempUsername('');
            };

            const filteredArticles = selectedCategory === "All" 
                ? articles 
                : articles.filter(article => article.category === selectedCategory);

            const featuredArticles = articles.filter(article => article.featured);

            if (selectedArticle) {
                return <ArticleView article={selectedArticle} darkMode={darkMode} setDarkMode={setDarkMode} onBack={() => setSelectedArticle(null)} user={user} username={username} savedArticles={savedArticles} toggleSaveArticle={toggleSaveArticle} openAuthModal={openAuthModal} />;
            }

            if (showAccountModal) {
                return <AccountDashboard user={user} darkMode={darkMode} setDarkMode={setDarkMode} onClose={() => setShowAccountModal(false)} savedArticles={savedArticles} articles={articles} setSelectedArticle={setSelectedArticle} />;
            }

            return (
                <div className={`min-h-screen transition-colors duration-200 ${darkMode ? 'bg-black text-gray-100' : 'bg-white text-gray-900'}`}>
                    {/* Header */}
                    <header className={`sticky top-0 z-50 transition-all duration-200 ${scrolled ? (darkMode ? 'bg-black/98 backdrop-blur-xl border-b border-gray-900' : 'bg-white/98 backdrop-blur-xl border-b border-gray-200') : (darkMode ? 'border-b border-gray-900' : 'border-b border-gray-200')}`}>
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex items-center justify-between h-16">
                                <div className="flex items-center space-x-12">
                                    <h1 className={`text-3xl font-serif font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                        OnPoint Articles
                                    </h1>
                                    <nav className="hidden md:flex space-x-8">
                                        {["World", "Legal", "Business", "Technology", "Opinion", "More"].map(item => (
                                            <a key={item} href="#" className={`text-sm font-medium transition-colors ${darkMode ? 'text-gray-300 hover:text-white' : 'text-gray-600 hover:text-gray-900'}`}>
                                                {item}
                                            </a>
                                        ))}
                                    </nav>
                                </div>
                                
                                <div className="flex items-center space-x-4">
                                    {user ? (
                                        <div className="relative flex items-center space-x-3">
                                            <button
                                                onClick={() => setShowUserMenu(!showUserMenu)}
                                                className={`flex items-center space-x-2 px-4 py-2 text-sm font-semibold transition-all ${darkMode ? 'bg-zinc-900 text-white hover:bg-zinc-800' : 'bg-gray-100 text-black hover:bg-gray-200'}`}
                                            >
                                                <div className={`w-8 h-8 flex items-center justify-center text-xs font-bold rounded-full ${darkMode ? 'bg-white text-black' : 'bg-black text-white'}`}>
                                                    {user.email.charAt(0).toUpperCase()}
                                                </div>
                                                <span className="hidden sm:block">{user.email.split('@')[0]}</span>
                                                <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                                                </svg>
                                            </button>

                                            {showUserMenu && (
                                                <div className={`absolute right-0 top-12 w-64 border ${darkMode ? 'bg-black border-gray-800' : 'bg-white border-gray-200'} shadow-lg z-50`}>
                                                    <div className={`px-4 py-3 border-b ${darkMode ? 'border-gray-800' : 'border-gray-200'}`}>
                                                        <p className={`text-sm font-semibold ${darkMode ? 'text-white' : 'text-gray-900'}`}>OnPoint Articles Account</p>
                                                        <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>{user.email}</p>
                                                    </div>
                                                    <button
                                                        onClick={() => { setShowUserMenu(false); setShowAccountModal(true); }}
                                                        className={`w-full text-left px-4 py-3 text-sm ${darkMode ? 'hover:bg-zinc-900 text-gray-300' : 'hover:bg-gray-50 text-gray-700'} transition-colors flex items-center space-x-2`}
                                                    >
                                                        <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                                        </svg>
                                                        <span>My Dashboard</span>
                                                    </button>
                                                    <button
                                                        onClick={() => { setShowUserMenu(false); setShowAccountModal(true); }}
                                                        className={`w-full text-left px-4 py-3 text-sm ${darkMode ? 'hover:bg-zinc-900 text-gray-300' : 'hover:bg-gray-50 text-gray-700'} transition-colors flex items-center space-x-2`}
                                                    >
                                                        <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
                                                        </svg>
                                                        <span>Saved Articles ({savedArticles.length})</span>
                                                    </button>
                                                    <button
                                                        onClick={() => { setShowUserMenu(false); netlifyIdentity.logout(); }}
                                                        className={`w-full text-left px-4 py-3 text-sm ${darkMode ? 'hover:bg-zinc-900 text-red-400' : 'hover:bg-gray-50 text-red-600'} transition-colors flex items-center space-x-2 border-t ${darkMode ? 'border-gray-800' : 'border-gray-200'}`}
                                                    >
                                                        <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                                                        </svg>
                                                        <span>Logout</span>
                                                    </button>
                                                </div>
                                            )}
                                        </div>
                                    ) : (
                                        <button
                                            onClick={() => netlifyIdentity.open()}
                                            className={`hidden sm:block px-5 py-2 text-sm font-semibold transition-all ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}
                                        >
                                            Create Account / Sign In
                                        </button>
                                    )}
                                    <button
                                        onClick={() => setDarkMode(!darkMode)}
                                        className={`p-2 transition-colors ${darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-gray-900'}`}
                                        aria-label="Toggle dark mode"
                                    >
                                        {darkMode ? (
                                            <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                                            </svg>
                                        ) : (
                                            <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                                            </svg>
                                        )}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* Live Updates Bar */}
                    <div className={`border-b ${darkMode ? 'bg-black border-gray-900' : 'bg-gray-50 border-gray-200'}`}>
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
                            <div className="flex items-center space-x-6 overflow-x-auto">
                                <div className="flex items-center space-x-2 flex-shrink-0">
                                    <span className="live-indicator w-1.5 h-1.5 bg-red-600 rounded-full"></span>
                                    <span className="text-xs font-bold uppercase tracking-widest text-red-600">Live</span>
                                </div>
                                <div className="flex space-x-8">
                                    {liveUpdates.map(update => (
                                        <div key={update.id} className="flex items-center space-x-3 flex-shrink-0">
                                            <span className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>{update.text}</span>
                                            <span className={`text-xs ${darkMode ? 'text-gray-600' : 'text-gray-400'}`}>{update.time}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Main Content */}
                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                        {/* Breaking News Section */}
                        {featuredArticles.length > 0 && (
                            <section className="mb-16">
                                {featuredArticles[0].breaking && (
                                    <div className="mb-8 py-4 text-center border-y-2 bg-red-600 border-red-600">
                                        <div className="flex items-center justify-center space-x-3">
                                            <span className="live-indicator w-2.5 h-2.5 bg-white rounded-full"></span>
                                            <span className="text-sm font-black uppercase tracking-widest text-white">Breaking News</span>
                                            <span className="live-indicator w-2.5 h-2.5 bg-white rounded-full"></span>
                                        </div>
                                    </div>
                                )}

                                <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                                    {/* Main Article */}
                                    <div className="lg:col-span-2">
                                        <div 
                                            onClick={() => setSelectedArticle(featuredArticles[0])}
                                            className={`cursor-pointer group ${darkMode ? 'bg-black border-2 border-gray-900' : 'bg-white border-2 border-gray-200'}`}
                                        >
                                            <div className="p-8">
                                                <div className="flex items-center space-x-3 mb-6">
                                                    <span className={`text-xs font-bold uppercase tracking-widest ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                        {featuredArticles[0].category}
                                                    </span>
                                                    <span className={`text-xs ${darkMode ? 'text-gray-700' : 'text-gray-300'}`}>•</span>
                                                    <span className={`text-xs ${darkMode ? 'text-gray-600' : 'text-gray-500'}`}>
                                                        {featuredArticles[0].readTime}
                                                    </span>
                                                </div>
                                                
                                                <h2 className={`text-5xl font-serif font-black mb-8 leading-[0.95] ${darkMode ? 'text-white group-hover:text-gray-200' : 'text-black group-hover:text-gray-800'} transition-colors`}>
                                                    LESTER TELLEZ CHARGED
                                                </h2>
                                                
                                                <div className="mb-8">
                                                    <div className={`mb-3 border ${darkMode ? 'border-gray-900' : 'border-gray-200'}`}>
                                                        <img 
                                                            src={featuredArticles[0].image} 
                                                            alt={featuredArticles[0].title}
                                                            className="w-full h-auto object-cover"
                                                        />
                                                    </div>
                                                    <p className={`text-xs leading-relaxed ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                        Florida International University campus, where Lester Tellez was arrested by FIU Campus Police on October 9, 2025.
                                                    </p>
                                                </div>
                                                
                                                <p className={`text-lg leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                                    Former UCF student body presidential candidate and creator of Five Nights at Freddy's fan game 'Grizzly's' arrested on FIU campus for battery on persons with disabilities. Trial set for December 8.
                                                </p>
                                                
                                                <div className={`pt-6 border-t ${darkMode ? 'border-gray-900' : 'border-gray-200'}`}>
                                                    <div className={`flex items-center space-x-2 text-sm ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                        <span className="font-semibold">By {featuredArticles[0].author}</span>
                                                        <span>•</span>
                                                        <span>{featuredArticles[0].date}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Live Updates Sidebar */}
                                    <div className="lg:col-span-1">
                                        {featuredArticles[0].liveUpdates && (
                                            <div className={`sticky top-24 border-2 ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-gray-50 border-gray-200'}`}>
                                                <div className={`px-5 py-4 border-b ${darkMode ? 'border-gray-900 bg-black' : 'border-gray-200 bg-white'}`}>
                                                    <div className="flex items-center space-x-2 mb-1">
                                                        <span className="live-indicator w-2 h-2 bg-red-600 rounded-full"></span>
                                                        <h3 className="text-xs font-black uppercase tracking-widest text-red-600">Live Updates</h3>
                                                    </div>
                                                    <p className={`text-xs mt-2 ${darkMode ? 'text-gray-600' : 'text-gray-500'}`}>
                                                        Latest: {featuredArticles[0].liveUpdates[0].time}
                                                    </p>
                                                </div>
                                                
                                                <div className="max-h-[600px] overflow-y-auto">
                                                    {featuredArticles[0].liveUpdates.map((update, index) => (
                                                        <div 
                                                            key={index} 
                                                            className={`px-5 py-4 border-b ${darkMode ? 'border-gray-900 hover:bg-black' : 'border-gray-200 hover:bg-white'} transition-colors`}
                                                        >
                                                            <div className="flex items-start space-x-3 mb-2">
                                                                <div className={`w-2 h-2 rounded-full mt-1.5 flex-shrink-0 ${index === 0 ? 'bg-red-600' : darkMode ? 'bg-gray-800' : 'bg-gray-300'}`}></div>
                                                                <span className={`text-xs font-bold ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                                    {update.time}
                                                                </span>
                                                            </div>
                                                            <p className={`text-sm leading-relaxed ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                                                {update.text}
                                                            </p>
                                                        </div>
                                                    ))}
                                                </div>
                                                
                                                <div className={`px-5 py-3 ${darkMode ? 'bg-black' : 'bg-white'}`}>
                                                    <button className={`text-xs font-bold uppercase tracking-wider w-full text-center ${darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-black'} transition-colors`}>
                                                        View Full Coverage →
                                                    </button>
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </section>
                        )}

                        {/* Category Filter */}
                        <div className={`mb-12 pb-6 border-b ${darkMode ? 'border-gray-900' : 'border-gray-200'}`}>
                            <div className="flex items-center space-x-1 overflow-x-auto">
                                {categories.map(category => (
                                    <button
                                        key={category}
                                        onClick={() => setSelectedCategory(category)}
                                        className={`category-pill px-5 py-2 text-sm font-medium whitespace-nowrap transition-all ${
                                            selectedCategory === category
                                                ? darkMode ? 'bg-white text-black' : 'bg-black text-white'
                                                : darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-gray-900'
                                        }`}
                                    >
                                        {category}
                                    </button>
                                ))}
                            </div>
                        </div>

                        {/* Article Grid */}
                        <section>
                            <h2 className="text-2xl font-serif font-bold mb-8">Latest Stories</h2>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                {filteredArticles.map(article => (
                                    <article 
                                        key={article.id}
                                        onClick={() => setSelectedArticle(article)}
                                        className={`overflow-hidden cursor-pointer group article-card ${darkMode ? 'bg-zinc-950 border border-gray-900' : 'bg-white border border-gray-200'}`}
                                    >
                                        <div className="aspect-[16/9] relative overflow-hidden">
                                            <img 
                                                src={article.image} 
                                                alt={article.title}
                                                className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                                            />
                                        </div>
                                        <div className="p-6">
                                            <div className="flex items-center space-x-2 mb-3">
                                                <span className={`text-xs font-semibold uppercase tracking-wider ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                    {article.category}
                                                </span>
                                                <span className={`text-xs ${darkMode ? 'text-gray-600' : 'text-gray-400'}`}>•</span>
                                                <span className={`text-xs ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                    {article.readTime}
                                                </span>
                                            </div>
                                            <h3 className={`text-xl font-serif font-bold mb-3 leading-tight line-clamp-2 ${darkMode ? 'group-hover:text-gray-300' : 'group-hover:text-gray-600'} transition-colors`}>
                                                {article.title}
                                            </h3>
                                            <p className={`text-sm mb-4 line-clamp-2 leading-relaxed ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                {article.excerpt}
                                            </p>
                                            <div className={`flex items-center space-x-2 text-xs ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                <span className="font-medium">{article.author}</span>
                                                <span>•</span>
                                                <span>{article.date}</span>
                                            </div>
                                        </div>
                                    </article>
                                ))}
                            </div>
                        </section>

                        {/* Newsletter Section */}
                        <section className={`mt-20 border ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-gray-50 border-gray-200'}`}>
                            <div className="p-12 text-center">
                                <h2 className="text-2xl font-serif font-bold mb-3">Subscribe to Our Newsletter</h2>
                                <p className={`text-base mb-8 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                    Get the most important news delivered to your inbox daily
                                </p>
                                <div className="flex max-w-md mx-auto gap-0">
                                    <input 
                                        type="email" 
                                        placeholder="Enter your email address"
                                        className={`flex-1 px-5 py-3 border focus:outline-none ${darkMode ? 'bg-black border-gray-800 text-white placeholder-gray-600' : 'bg-white border-gray-300 text-gray-900 placeholder-gray-400'}`}
                                    />
                                    <button className={`px-8 py-3 font-semibold transition-colors ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}>
                                        Subscribe
                                    </button>
                                </div>
                            </div>
                        </section>
                    </main>

                    {/* Footer */}
                    <footer className={`border-t mt-20 ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-white border-gray-200'}`}>
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-8 mb-8">
                                {[
                                    { title: "Sections", items: ["World", "Business", "Technology", "Science"] },
                                    { title: "Company", items: ["About", "Careers", "Contact", "Advertise"] },
                                    { title: "Legal", items: ["Privacy Policy", "Terms of Service", "Cookie Policy"] },
                                    { title: "Follow", items: ["Twitter", "LinkedIn", "Instagram", "Facebook"] }
                                ].map(section => (
                                    <div key={section.title}>
                                        <h3 className="font-semibold text-sm mb-4 uppercase tracking-wider">{section.title}</h3>
                                        <ul className={`space-y-2.5 text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                            {section.items.map(item => (
                                                <li key={item}>
                                                    <a href="#" className={`transition-colors ${darkMode ? 'hover:text-white' : 'hover:text-gray-900'}`}>
                                                        {item}
                                                    </a>
                                                </li>
                                            ))}
                                        </ul>
                                    </div>
                                ))}
                            </div>
                            <div className={`pt-8 border-t ${darkMode ? 'border-gray-900 text-gray-500' : 'border-gray-200 text-gray-600'} text-xs`}>
                                <p>&copy; 2025 OnPoint Articles. All rights reserved.</p>
                            </div>
                        </div>
                    </footer>

                    {/* Clean Login/Signup Modal */}
                    {showLoginModal && (
                        <div className="fixed inset-0 z-[9999] overflow-y-auto bg-black bg-opacity-90 flex items-center justify-center p-4">
                            <div className={`relative w-full max-w-md ${darkMode ? 'bg-black' : 'bg-white'}`}>
                                {/* Close Button */}
                                <button
                                    onClick={() => setShowLoginModal(false)}
                                    className={`absolute top-6 right-6 transition-colors ${darkMode ? 'text-gray-600 hover:text-white' : 'text-gray-400 hover:text-gray-900'}`}
                                >
                                    <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>

                                {/* Content */}
                                <div className="px-8 py-12 md:px-12 md:py-16">
                                    {/* Logo */}
                                    <div className="text-center mb-8">
                                        <div className={`inline-flex items-center justify-center w-16 h-16 mb-6 text-sm font-black ${darkMode ? 'bg-white text-black' : 'bg-black text-white'}`}>
                                            OPA
                                        </div>
                                        <h1 className={`text-2xl md:text-3xl font-serif font-bold mb-2 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                            OnPoint Articles
                                        </h1>
                                        <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                            {authMode === 'signup' ? 'Create your free account' : 'Welcome back'}
                                        </p>
                                    </div>

                                    {/* Auth Form */}
                                    <form onSubmit={handleAuthSubmit} className="space-y-4 mb-6">
                                        {authError && (
                                            <div className={`p-3 text-sm border ${darkMode ? 'bg-red-900/20 border-red-800 text-red-400' : 'bg-red-50 border-red-200 text-red-600'}`}>
                                                {authError}
                                            </div>
                                        )}

                                        {authMode === 'signup' && (
                                            <div>
                                                <label className={`block text-sm font-medium mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                                    Full Name
                                                </label>
                                                <input
                                                    type="text"
                                                    value={authName}
                                                    onChange={(e) => setAuthName(e.target.value)}
                                                    placeholder="John Doe"
                                                    className={`w-full px-4 py-3 text-base border focus:outline-none focus:ring-2 focus:ring-blue-500 ${darkMode ? 'bg-zinc-900 border-gray-800 text-white placeholder-gray-600' : 'bg-white border-gray-300 text-gray-900 placeholder-gray-400'}`}
                                                    disabled={authLoading}
                                                />
                                            </div>
                                        )}

                                        <div>
                                            <label className={`block text-sm font-medium mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                                Email Address
                                            </label>
                                            <input
                                                type="email"
                                                value={authEmail}
                                                onChange={(e) => setAuthEmail(e.target.value)}
                                                placeholder="you@example.com"
                                                className={`w-full px-4 py-3 text-base border focus:outline-none focus:ring-2 focus:ring-blue-500 ${darkMode ? 'bg-zinc-900 border-gray-800 text-white placeholder-gray-600' : 'bg-white border-gray-300 text-gray-900 placeholder-gray-400'}`}
                                                disabled={authLoading}
                                            />
                                        </div>

                                        <div>
                                            <label className={`block text-sm font-medium mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                                Password
                                            </label>
                                            <input
                                                type="password"
                                                value={authPassword}
                                                onChange={(e) => setAuthPassword(e.target.value)}
                                                placeholder={authMode === 'signup' ? 'At least 6 characters' : 'Enter your password'}
                                                className={`w-full px-4 py-3 text-base border focus:outline-none focus:ring-2 focus:ring-blue-500 ${darkMode ? 'bg-zinc-900 border-gray-800 text-white placeholder-gray-600' : 'bg-white border-gray-300 text-gray-900 placeholder-gray-400'}`}
                                                disabled={authLoading}
                                            />
                                        </div>

                                        <button
                                            type="submit"
                                            disabled={authLoading}
                                            className={`w-full px-6 py-4 text-base font-semibold transition-all ${authLoading ? 'opacity-50 cursor-not-allowed' : ''} ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}
                                        >
                                            {authLoading ? 'Please wait...' : (authMode === 'signup' ? 'Create Account' : 'Sign In')}
                                        </button>
                                    </form>

                                    {/* Toggle Mode */}
                                    <div className="text-center mb-6">
                                        <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                            {authMode === 'signup' ? 'Already have an account?' : "Don't have an account?"}
                                            {' '}
                                            <button
                                                type="button"
                                                onClick={() => {
                                                    setAuthMode(authMode === 'signup' ? 'signin' : 'signup');
                                                    setAuthError('');
                                                    setAuthEmail('');
                                                    setAuthPassword('');
                                                    setAuthName('');
                                                }}
                                                className={`font-semibold ${darkMode ? 'text-white hover:underline' : 'text-black hover:underline'}`}
                                            >
                                                {authMode === 'signup' ? 'Sign In' : 'Sign Up'}
                                            </button>
                                        </p>
                                    </div>

                                    {/* Benefits */}
                                    <div className={`mt-8 pt-8 border-t ${darkMode ? 'border-gray-900' : 'border-gray-200'}`}>
                                        <p className={`text-xs font-semibold uppercase tracking-wider mb-4 ${darkMode ? 'text-gray-600' : 'text-gray-500'}`}>
                                            What you get
                                        </p>
                                        <div className="space-y-3">
                                            <div className="flex items-center space-x-3">
                                                <svg className={`w-5 h-5 flex-shrink-0 ${darkMode ? 'text-gray-600' : 'text-gray-400'}`} fill="currentColor" viewBox="0 0 20 20">
                                                    <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                                </svg>
                                                <span className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Full access to all articles</span>
                                            </div>
                                            <div className="flex items-center space-x-3">
                                                <svg className={`w-5 h-5 flex-shrink-0 ${darkMode ? 'text-gray-600' : 'text-gray-400'}`} fill="currentColor" viewBox="0 0 20 20">
                                                    <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                                </svg>
                                                <span className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Comment and engage with the community</span>
                                            </div>
                                            <div className="flex items-center space-x-3">
                                                <svg className={`w-5 h-5 flex-shrink-0 ${darkMode ? 'text-gray-600' : 'text-gray-400'}`} fill="currentColor" viewBox="0 0 20 20">
                                                    <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                                </svg>
                                                <span className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Save articles for later</span>
                                            </div>
                                            <div className="flex items-center space-x-3">
                                                <svg className={`w-5 h-5 flex-shrink-0 ${darkMode ? 'text-gray-600' : 'text-gray-400'}`} fill="currentColor" viewBox="0 0 20 20">
                                                    <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                                </svg>
                                                <span className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Free forever, no credit card required</span>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Terms */}
                                    <p className={`mt-8 text-xs text-center ${darkMode ? 'text-gray-600' : 'text-gray-500'}`}>
                                        By continuing, you agree to our{' '}
                                        <button onClick={openTOS} className="underline hover:no-underline">Terms of Service</button>
                                        {' '}and{' '}
                                        <button onClick={openTOS} className="underline hover:no-underline">Privacy Policy</button>
                                    </p>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Terms of Service Modal */}
                    {showTOSModal && (
                        <div className="fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-75 flex items-center justify-center p-4">
                            <div className={`relative w-full max-w-4xl transform transition-all ${darkMode ? 'bg-zinc-950 border-2 border-gray-800' : 'bg-white border-2 border-gray-300'}`}>
                                {/* Header */}
                                <div className={`px-6 py-5 border-b ${darkMode ? 'border-gray-800' : 'border-gray-300'}`}>
                                    <div className="flex items-center justify-between">
                                        <h2 className={`text-2xl font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                            Terms of Service & Community Guidelines
                                        </h2>
                                        <button
                                            onClick={() => setShowTOSModal(false)}
                                            className={`transition-colors ${darkMode ? 'text-gray-500 hover:text-white' : 'text-gray-400 hover:text-gray-900'}`}
                                        >
                                            <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>

                                {/* Body - Scrollable */}
                                <div className="px-6 py-6 max-h-[70vh] overflow-y-auto">
                                    <div className={`space-y-6 text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                        <div>
                                            <p className={`text-xs ${darkMode ? 'text-gray-500' : 'text-gray-500'} mb-4`}>
                                                <strong>Effective Date:</strong> October 13, 2025 | <strong>Last Updated:</strong> October 13, 2025
                                            </p>
                                        </div>

                                        <section>
                                            <h3 className={`text-lg font-bold mb-3 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                1. Acceptance of Terms
                                            </h3>
                                            <p className="mb-2">
                                                By accessing or using OnPoint Articles' commenting system, you agree to be bound by these Terms of Service ("Terms"). If you do not agree to these Terms, you may not access or use the commenting features of our platform.
                                            </p>
                                            <p>
                                                These Terms apply to all users, including registered users, commenters, and those who interact with comments through likes or replies.
                                            </p>
                                        </section>

                                        <section>
                                            <h3 className={`text-lg font-bold mb-3 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                2. Community Guidelines & Prohibited Conduct
                                            </h3>
                                            <p className="mb-3">
                                                OnPoint Articles is committed to fostering a respectful, informative, and constructive community. Users must adhere to the following guidelines:
                                            </p>

                                            <div className={`pl-4 space-y-3 border-l-2 ${darkMode ? 'border-blue-900' : 'border-blue-300'}`}>
                                                <div>
                                                    <h4 className="font-bold mb-1">2.1 Respectful Discourse</h4>
                                                    <ul className="list-disc list-inside space-y-1 ml-2">
                                                        <li>Engage in civil, respectful dialogue</li>
                                                        <li>Disagree with ideas, not people</li>
                                                        <li>Avoid personal attacks, insults, or ad hominem arguments</li>
                                                        <li>Do not harass, threaten, or intimidate other users</li>
                                                    </ul>
                                                </div>

                                                <div>
                                                    <h4 className="font-bold mb-1">2.2 Prohibited Content</h4>
                                                    <p className="mb-1">Users may not post comments containing:</p>
                                                    <ul className="list-disc list-inside space-y-1 ml-2">
                                                        <li><strong>Hate speech:</strong> Content that attacks or demeans individuals or groups based on race, ethnicity, national origin, religion, gender, sexual orientation, disability, or other protected characteristics</li>
                                                        <li><strong>Harassment or bullying:</strong> Targeted abuse, stalking, doxxing, or coordinated harassment</li>
                                                        <li><strong>Threats of violence:</strong> Direct or indirect threats of physical harm to any person or group</li>
                                                        <li><strong>Illegal content:</strong> Content that promotes, facilitates, or glorifies illegal activities</li>
                                                        <li><strong>Graphic violence or gore:</strong> Excessively violent or disturbing imagery or descriptions</li>
                                                        <li><strong>Sexual content:</strong> Sexually explicit material, solicitation, or content sexualizing minors</li>
                                                        <li><strong>Misinformation:</strong> Deliberate false information presented as fact, particularly related to public health, elections, or safety</li>
                                                        <li><strong>Spam:</strong> Repetitive comments, promotional content, or off-topic spam</li>
                                                        <li><strong>Impersonation:</strong> Pretending to be another person, organization, or entity</li>
                                                        <li><strong>Copyrighted material:</strong> Unauthorized use of copyrighted content without permission</li>
                                                    </ul>
                                                </div>

                                                <div>
                                                    <h4 className="font-bold mb-1">2.3 Stay On Topic</h4>
                                                    <ul className="list-disc list-inside space-y-1 ml-2">
                                                        <li>Keep comments relevant to the article and discussion</li>
                                                        <li>Avoid derailing conversations with off-topic tangents</li>
                                                        <li>Do not post promotional or commercial content unless relevant to the discussion</li>
                                                    </ul>
                                                </div>

                                                <div>
                                                    <h4 className="font-bold mb-1">2.4 Authentic Engagement</h4>
                                                    <ul className="list-disc list-inside space-y-1 ml-2">
                                                        <li>Do not manipulate discussions through multiple accounts</li>
                                                        <li>Do not artificially inflate likes or engagement</li>
                                                        <li>Do not coordinate brigading or mass reporting</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </section>

                                        <section>
                                            <h3 className={`text-lg font-bold mb-3 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                3. Account Responsibilities
                                            </h3>
                                            <ul className="list-disc list-inside space-y-1 ml-2">
                                                <li>You are responsible for all activity on your account</li>
                                                <li>Keep your login credentials secure and confidential</li>
                                                <li>Notify us immediately of any unauthorized access</li>
                                                <li>You must be at least 13 years old to create an account</li>
                                                <li>You may not share or transfer your account</li>
                                            </ul>
                                        </section>

                                        <section>
                                            <h3 className={`text-lg font-bold mb-3 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                4. Content Ownership & Rights
                                            </h3>
                                            <p className="mb-2">
                                                <strong>Your Content:</strong> You retain ownership of the comments you post. However, by posting, you grant OnPoint Articles a worldwide, non-exclusive, royalty-free license to use, display, reproduce, and distribute your comments on our platform.
                                            </p>
                                            <p className="mb-2">
                                                <strong>Our Content:</strong> All articles, reporter comments, and editorial content remain the property of OnPoint Articles and are protected by copyright law.
                                            </p>
                                            <p>
                                                <strong>Removal Rights:</strong> OnPoint Articles reserves the right to remove, edit, or refuse to publish any comment at our sole discretion.
                                            </p>
                                        </section>

                                        <section>
                                            <h3 className={`text-lg font-bold mb-3 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                5. Moderation & Enforcement
                                            </h3>
                                            <p className="mb-2">OnPoint Articles employs a combination of automated and manual moderation to enforce these Terms. Violations may result in:</p>
                                            <ul className="list-disc list-inside space-y-1 ml-2 mb-3">
                                                <li><strong>Comment removal:</strong> Individual comments that violate Terms will be deleted</li>
                                                <li><strong>Temporary suspension:</strong> Repeated minor violations or first-time serious violations</li>
                                                <li><strong>Permanent ban:</strong> Severe violations or repeated offenses after warnings</li>
                                                <li><strong>Legal action:</strong> In cases involving threats, harassment, or illegal activity</li>
                                            </ul>
                                            <p>
                                                We strive to be transparent in our moderation but reserve the right to take action without prior warning for severe violations.
                                            </p>
                                        </section>

                                        <section>
                                            <h3 className={`text-lg font-bold mb-3 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                6. Privacy & Data Collection
                                            </h3>
                                            <p className="mb-2">
                                                We collect and process personal information in accordance with our Privacy Policy. By using our commenting system, you consent to:
                                            </p>
                                            <ul className="list-disc list-inside space-y-1 ml-2">
                                                <li>Collection of your email address for authentication</li>
                                                <li>Public display of your chosen username</li>
                                                <li>Storage of your comments and engagement history</li>
                                                <li>Use of cookies and tracking technologies</li>
                                            </ul>
                                        </section>

                                        <section>
                                            <h3 className={`text-lg font-bold mb-3 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                7. Disclaimer of Warranties
                                            </h3>
                                            <p className="mb-2">
                                                OnPoint Articles provides the commenting system "as is" without warranties of any kind. We do not guarantee:
                                            </p>
                                            <ul className="list-disc list-inside space-y-1 ml-2">
                                                <li>Uninterrupted or error-free service</li>
                                                <li>Accuracy of user-generated content</li>
                                                <li>Protection against offensive or harmful content</li>
                                                <li>Permanent storage of comments</li>
                                            </ul>
                                        </section>

                                        <section>
                                            <h3 className={`text-lg font-bold mb-3 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                8. Limitation of Liability
                                            </h3>
                                            <p>
                                                OnPoint Articles shall not be liable for any indirect, incidental, special, or consequential damages arising from your use of the commenting system, including but not limited to damages from user-generated content, service interruptions, or data loss.
                                            </p>
                                        </section>

                                        <section>
                                            <h3 className={`text-lg font-bold mb-3 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                9. Changes to Terms
                                            </h3>
                                            <p>
                                                We reserve the right to modify these Terms at any time. Material changes will be communicated through the platform. Continued use of the commenting system after changes constitutes acceptance of the modified Terms.
                                            </p>
                                        </section>

                                        <section>
                                            <h3 className={`text-lg font-bold mb-3 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                10. Contact & Reporting
                                            </h3>
                                            <p className="mb-2">
                                                For questions about these Terms or to report violations, contact us at:
                                            </p>
                                            <div className={`p-3 border ${darkMode ? 'bg-zinc-900 border-gray-800' : 'bg-gray-50 border-gray-200'}`}>
                                                <p><strong>Email:</strong> support@onpointarticles.com</p>
                                                <p><strong>Report Abuse:</strong> abuse@onpointarticles.com</p>
                                            </div>
                                        </section>

                                        <section className={`pt-6 border-t ${darkMode ? 'border-gray-800' : 'border-gray-300'}`}>
                                            <p className={`text-xs ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                By clicking "I agree" and using OnPoint Articles' commenting features, you acknowledge that you have read, understood, and agree to be bound by these Terms of Service.
                                            </p>
                                        </section>
                                    </div>
                                </div>

                                {/* Footer */}
                                <div className={`px-6 py-4 border-t ${darkMode ? 'border-gray-800 bg-zinc-950' : 'border-gray-300 bg-gray-50'} flex items-center justify-center`}>
                                    <button
                                        onClick={() => setShowTOSModal(false)}
                                        className={`px-6 py-2 text-sm font-semibold transition-all ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}
                                    >
                                        Close
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Username Selection Modal */}
                    {showUsernameModal && user && (
                        <div className="fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-75 flex items-center justify-center p-4">
                            <div className={`relative w-full max-w-md transform transition-all ${darkMode ? 'bg-zinc-950 border-2 border-gray-800' : 'bg-white border-2 border-gray-300'}`}>
                                {/* Header */}
                                <div className={`px-6 py-5 border-b ${darkMode ? 'border-gray-800' : 'border-gray-300'}`}>
                                    <h2 className={`text-2xl font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                        Choose Your Username
                                    </h2>
                                </div>

                                {/* Body */}
                                <div className="px-6 py-6">
                                    <div className={`mb-6 p-4 border ${darkMode ? 'bg-blue-900/20 border-blue-800' : 'bg-blue-50 border-blue-200'}`}>
                                        <h3 className={`font-bold mb-2 ${darkMode ? 'text-blue-300' : 'text-blue-900'}`}>
                                            Welcome to OnPoint Articles!
                                        </h3>
                                        <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-700'}`}>
                                            Choose a username that will be displayed when you comment. This keeps your email private.
                                        </p>
                                    </div>

                                    <div className="space-y-4">
                                        <div>
                                            <label className={`block text-sm font-bold mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                                Username
                                            </label>
                                            <input
                                                type="text"
                                                value={tempUsername}
                                                onChange={(e) => setTempUsername(e.target.value)}
                                                placeholder="Enter username..."
                                                maxLength={20}
                                                className={`w-full px-4 py-3 text-base border focus:outline-none focus:ring-2 focus:ring-blue-500 ${darkMode ? 'bg-black border-gray-800 text-white placeholder-gray-600' : 'bg-white border-gray-300 text-gray-900 placeholder-gray-400'}`}
                                                onKeyPress={(e) => { if (e.key === 'Enter') saveUsername(); }}
                                            />
                                        </div>

                                        <div className={`p-3 text-xs space-y-1 border ${darkMode ? 'bg-zinc-900 border-gray-800 text-gray-400' : 'bg-gray-50 border-gray-200 text-gray-600'}`}>
                                            <p className="font-bold">Username requirements:</p>
                                            <ul className="list-disc list-inside space-y-1 ml-2">
                                                <li>3-20 characters</li>
                                                <li>Letters, numbers, underscores (_), and hyphens (-) only</li>
                                                <li>Will be publicly visible on your comments</li>
                                            </ul>
                                        </div>

                                        <div className={`p-3 text-xs border ${darkMode ? 'bg-yellow-900/20 border-yellow-800 text-yellow-300' : 'bg-yellow-50 border-yellow-200 text-yellow-800'}`}>
                                            <p className="font-bold mb-1">Privacy Note:</p>
                                            <p>Your email ({user.email}) will never be shown publicly. Only your username will appear on comments.</p>
                                        </div>
                                    </div>
                                </div>

                                {/* Footer */}
                                <div className={`px-6 py-4 border-t ${darkMode ? 'border-gray-800 bg-zinc-950' : 'border-gray-300 bg-gray-50'} flex items-center justify-end`}>
                                    <button
                                        onClick={saveUsername}
                                        disabled={!tempUsername.trim()}
                                        className={`px-6 py-2 text-sm font-semibold transition-all ${!tempUsername.trim() ? 'opacity-50 cursor-not-allowed' : ''} ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}
                                    >
                                        Save Username
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        function AccountDashboard({ user, darkMode, setDarkMode, onClose, savedArticles, articles, setSelectedArticle }) {
            const [activeTab, setActiveTab] = useState('dashboard');

            const savedArticlesList = articles.filter(a => savedArticles.includes(a.id));

            return (
                <div className={`min-h-screen transition-colors duration-200 ${darkMode ? 'bg-black text-gray-100' : 'bg-white text-gray-900'}`}>
                    {/* Header */}
                    <header className={`sticky top-0 z-50 border-b ${darkMode ? 'bg-black/98 backdrop-blur-xl border-gray-900' : 'bg-white/98 backdrop-blur-xl border-gray-200'}`}>
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex items-center justify-between h-16">
                                <div className="flex items-center space-x-8">
                                    <button
                                        onClick={onClose}
                                        className={`flex items-center space-x-2 ${darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-gray-900'} transition-colors`}
                                    >
                                        <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                                        </svg>
                                        <span className="font-medium text-sm">Back</span>
                                    </button>
                                    <h1 className={`text-2xl font-serif font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                        OnPoint Articles
                                    </h1>
                                </div>

                                <button
                                    onClick={() => setDarkMode(!darkMode)}
                                    className={`p-2 transition-colors ${darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-gray-900'}`}
                                    aria-label="Toggle dark mode"
                                >
                                    {darkMode ? (
                                        <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                                        </svg>
                                    ) : (
                                        <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                                        </svg>
                                    )}
                                </button>
                            </div>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                        <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
                            {/* Sidebar */}
                            <div className="lg:col-span-1">
                                <div className={`border ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-white border-gray-200'} p-6`}>
                                    <div className="flex flex-col items-center mb-6">
                                        <div className={`w-20 h-20 flex items-center justify-center text-2xl font-bold rounded-full mb-3 ${darkMode ? 'bg-white text-black' : 'bg-black text-white'}`}>
                                            {user.email.charAt(0).toUpperCase()}
                                        </div>
                                        <h2 className={`text-lg font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`}>{user.email.split('@')[0]}</h2>
                                        <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>{user.email}</p>
                                    </div>

                                    <nav className="space-y-2">
                                        <button
                                            onClick={() => setActiveTab('dashboard')}
                                            className={`w-full text-left px-4 py-2 text-sm font-medium transition-colors ${activeTab === 'dashboard' ? (darkMode ? 'bg-white text-black' : 'bg-black text-white') : (darkMode ? 'text-gray-300 hover:bg-zinc-900' : 'text-gray-700 hover:bg-gray-100')}`}
                                        >
                                            Dashboard
                                        </button>
                                        <button
                                            onClick={() => setActiveTab('saved')}
                                            className={`w-full text-left px-4 py-2 text-sm font-medium transition-colors ${activeTab === 'saved' ? (darkMode ? 'bg-white text-black' : 'bg-black text-white') : (darkMode ? 'text-gray-300 hover:bg-zinc-900' : 'text-gray-700 hover:bg-gray-100')}`}
                                        >
                                            Saved Articles ({savedArticles.length})
                                        </button>
                                        <button
                                            onClick={() => setActiveTab('preferences')}
                                            className={`w-full text-left px-4 py-2 text-sm font-medium transition-colors ${activeTab === 'preferences' ? (darkMode ? 'bg-white text-black' : 'bg-black text-white') : (darkMode ? 'text-gray-300 hover:bg-zinc-900' : 'text-gray-700 hover:bg-gray-100')}`}
                                        >
                                            Preferences
                                        </button>
                                    </nav>
                                </div>
                            </div>

                            {/* Content Area */}
                            <div className="lg:col-span-3">
                                {activeTab === 'dashboard' && (
                                    <div>
                                        <h2 className="text-3xl font-serif font-bold mb-6">Welcome back!</h2>

                                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                                            <div className={`border ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-white border-gray-200'} p-6`}>
                                                <div className={`text-3xl font-bold mb-2 ${darkMode ? 'text-white' : 'text-gray-900'}`}>{savedArticles.length}</div>
                                                <div className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Saved Articles</div>
                                            </div>
                                            <div className={`border ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-white border-gray-200'} p-6`}>
                                                <div className={`text-3xl font-bold mb-2 ${darkMode ? 'text-white' : 'text-gray-900'}`}>0</div>
                                                <div className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Articles Read</div>
                                            </div>
                                            <div className={`border ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-white border-gray-200'} p-6`}>
                                                <div className={`text-3xl font-bold mb-2 ${darkMode ? 'text-white' : 'text-gray-900'}`}>Member</div>
                                                <div className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Account Status</div>
                                            </div>
                                        </div>

                                        <div className={`border ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-white border-gray-200'} p-8`}>
                                            <h3 className={`text-xl font-bold mb-4 ${darkMode ? 'text-white' : 'text-gray-900'}`}>Account Information</h3>
                                            <div className="space-y-4">
                                                <div>
                                                    <label className={`text-sm font-semibold ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Email</label>
                                                    <p className={`text-base ${darkMode ? 'text-white' : 'text-gray-900'}`}>{user.email}</p>
                                                </div>
                                                <div>
                                                    <label className={`text-sm font-semibold ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Account Type</label>
                                                    <p className={`text-base ${darkMode ? 'text-white' : 'text-gray-900'}`}>OnPoint Articles Member</p>
                                                </div>
                                                <div>
                                                    <label className={`text-sm font-semibold ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Member Since</label>
                                                    <p className={`text-base ${darkMode ? 'text-white' : 'text-gray-900'}`}>{new Date(user.created_at).toLocaleDateString()}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {activeTab === 'saved' && (
                                    <div>
                                        <h2 className="text-3xl font-serif font-bold mb-6">Saved Articles</h2>
                                        {savedArticlesList.length === 0 ? (
                                            <div className={`border ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-white border-gray-200'} p-12 text-center`}>
                                                <svg className={`w-16 h-16 mx-auto mb-4 ${darkMode ? 'text-gray-700' : 'text-gray-300'}`} fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
                                                </svg>
                                                <p className={`text-lg ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>No saved articles yet</p>
                                                <button onClick={onClose} className={`mt-4 px-6 py-2 text-sm font-semibold transition-all ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}>
                                                    Browse Articles
                                                </button>
                                            </div>
                                        ) : (
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                {savedArticlesList.map(article => (
                                                    <article
                                                        key={article.id}
                                                        onClick={() => { onClose(); setSelectedArticle(article); }}
                                                        className={`cursor-pointer overflow-hidden group ${darkMode ? 'bg-zinc-950 border border-gray-900' : 'bg-white border border-gray-200'} hover:scale-[1.02] transition-transform`}
                                                    >
                                                        <div className="aspect-[16/9] relative overflow-hidden">
                                                            <img
                                                                src={article.image}
                                                                alt={article.title}
                                                                className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                                                            />
                                                        </div>
                                                        <div className="p-5">
                                                            <span className={`text-xs font-semibold uppercase tracking-wider ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                                {article.category}
                                                            </span>
                                                            <h3 className={`text-lg font-serif font-bold mt-2 mb-2 leading-tight ${darkMode ? 'group-hover:text-gray-300' : 'group-hover:text-gray-600'} transition-colors`}>
                                                                {article.title}
                                                            </h3>
                                                            <p className={`text-sm mb-4 line-clamp-2 leading-relaxed ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                                {article.excerpt}
                                                            </p>
                                                        </div>
                                                    </article>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                )}

                                {activeTab === 'preferences' && (
                                    <div>
                                        <h2 className="text-3xl font-serif font-bold mb-6">Preferences</h2>
                                        <div className={`border ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-white border-gray-200'} p-8`}>
                                            <h3 className={`text-lg font-bold mb-4 ${darkMode ? 'text-white' : 'text-gray-900'}`}>Notifications</h3>
                                            <div className="space-y-4">
                                                <label className="flex items-center justify-between cursor-pointer">
                                                    <span className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Email notifications for new articles</span>
                                                    <input type="checkbox" className="w-4 h-4" defaultChecked />
                                                </label>
                                                <label className="flex items-center justify-between cursor-pointer">
                                                    <span className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Breaking news alerts</span>
                                                    <input type="checkbox" className="w-4 h-4" defaultChecked />
                                                </label>
                                            </div>

                                            <hr className={`my-6 ${darkMode ? 'border-gray-800' : 'border-gray-200'}`} />

                                            <h3 className={`text-lg font-bold mb-4 ${darkMode ? 'text-white' : 'text-gray-900'}`}>Display</h3>
                                            <label className="flex items-center justify-between cursor-pointer">
                                                <span className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Dark mode</span>
                                                <input type="checkbox" className="w-4 h-4" checked={darkMode} onChange={() => setDarkMode(!darkMode)} />
                                            </label>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    </main>
                </div>
            );
        }

        function ArticleView({ article, darkMode, setDarkMode, onBack, user, username, savedArticles, toggleSaveArticle, openAuthModal }) {
            const [currentTime, setCurrentTime] = useState(new Date());
            const [comments, setComments] = useState([]);
            const [displayedUserComments, setDisplayedUserComments] = useState([]);
            const [commentText, setCommentText] = useState('');
            const [commentType, setCommentType] = useState('user');
            const [isSubmitting, setIsSubmitting] = useState(false);
            const [isAdmin, setIsAdmin] = useState(false);
            const [replyingTo, setReplyingTo] = useState(null);
            const [replyText, setReplyText] = useState('');
            const [showEditModal, setShowEditModal] = useState(false);
            const [editArticleTitle, setEditArticleTitle] = useState(article.title);
            const [editWhatYouMustKnow, setEditWhatYouMustKnow] = useState('');
            const [editArticleBody, setEditArticleBody] = useState('');

            useEffect(() => {
                window.scrollTo(0, 0);
            }, []);

            // Check if user is admin
            useEffect(() => {
                if (user && user.email === 'jaydenmdavis2008@outlook.com') {
                    setIsAdmin(true);
                }
            }, [user]);

            // Fetch comments on mount and poll for updates
            useEffect(() => {
                const fetchComments = async () => {
                    try {
                        console.log('🔄 Fetching comments for article:', article.id);
                        const response = await fetch(`/.netlify/functions/article-comments?articleId=${article.id}`);
                        const data = await response.json();
                        console.log('📥 Fetched comments:', data.comments?.length || 0, 'total');
                        if (data.comments && data.comments.length > 0) {
                            console.log('Comment IDs:', data.comments.map(c => c.id));
                        }
                        setComments(data.comments || []);
                        // Initialize displayed user comments on first load
                        if (displayedUserComments.length === 0) {
                            setDisplayedUserComments(data.comments || []);
                        }
                    } catch (error) {
                        console.error('❌ Error fetching comments:', error);
                    }
                };

                fetchComments();

                // Poll for new comments every 30 seconds (reporter comments update automatically)
                const interval = setInterval(fetchComments, 30000);

                return () => clearInterval(interval);
            }, [article.id]);

            // Manual refresh function for user comments
            const refreshUserComments = () => {
                setDisplayedUserComments(comments);
            };

            // Update time every 10 seconds to keep relative timestamps accurate
            useEffect(() => {
                const interval = setInterval(() => {
                    setCurrentTime(new Date());
                }, 10000); // Update every 10 seconds

                return () => clearInterval(interval);
            }, []);

            // Submit comment
            const handleSubmitComment = async (e) => {
                e.preventDefault();

                console.log('=== Submitting Comment ===');
                console.log('Comment type:', commentType);
                console.log('Comment text:', commentText);
                console.log('Article ID:', article.id);

                if (!commentText.trim() || isSubmitting) {
                    console.log('Comment text empty or already submitting');
                    return;
                }

                if (!user) {
                    console.log('User not logged in');
                    alert('Please log in to comment');
                    return;
                }

                setIsSubmitting(true);

                try {
                    const currentUser = netlifyIdentity.currentUser();
                    const token = currentUser?.token?.access_token;

                    console.log('User email:', currentUser?.email);
                    console.log('Token present:', !!token);

                    if (!token) {
                        console.error('No token available');
                        alert('Authentication error. Please try logging out and back in.');
                        setIsSubmitting(false);
                        return;
                    }

                    const requestBody = {
                        articleId: article.id,
                        text: commentText,
                        type: commentType,
                        username: username
                    };

                    console.log('Making comment request to:', '/.netlify/functions/article-comments');
                    console.log('Request body:', requestBody);

                    const response = await fetch('/.netlify/functions/article-comments', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify(requestBody)
                    });

                    console.log('Comment response status:', response.status);
                    console.log('Comment response ok:', response.ok);

                    if (response.ok) {
                        const data = await response.json();
                        console.log('Comment posted successfully:', data);
                        setComments(data.comments);
                        setDisplayedUserComments(data.comments); // Update displayed comments immediately
                        setCommentText('');
                        showSuccess('Comment posted!');
                    } else {
                        const error = await response.json();
                        console.error('Comment error response:', error);
                        alert('Error posting comment: ' + (error.error || 'Unknown error'));
                    }
                } catch (error) {
                    console.error('=== Comment Error ===');
                    console.error('Error posting comment:', error);
                    console.error('Error stack:', error.stack);
                    alert('Network error. Please check your connection and try again.');
                }

                setIsSubmitting(false);
            };

            // Submit reply
            const handleSubmitReply = async (commentId) => {
                console.log('=== Submitting Reply ===');
                console.log('Comment ID:', commentId);
                console.log('Reply text:', replyText);

                if (!replyText.trim() || isSubmitting) {
                    console.log('Reply text empty or already submitting');
                    return;
                }

                if (!user) {
                    console.log('User not logged in');
                    alert('Please log in to reply');
                    return;
                }

                setIsSubmitting(true);

                try {
                    const currentUser = netlifyIdentity.currentUser();
                    const token = currentUser?.token?.access_token;

                    console.log('User email:', currentUser?.email);
                    console.log('Token present:', !!token);

                    if (!token) {
                        console.error('No token available');
                        alert('Authentication error. Please try logging out and back in.');
                        setIsSubmitting(false);
                        return;
                    }

                    const requestBody = {
                        articleId: article.id,
                        commentId: commentId,
                        text: replyText,
                        username: username
                    };

                    console.log('Making reply request to:', '/.netlify/functions/article-comments');
                    console.log('Request body with action:', { ...requestBody, action: 'reply' });

                    const response = await fetch('/.netlify/functions/article-comments', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({
                            ...requestBody,
                            action: 'reply'
                        })
                    });

                    console.log('Reply response status:', response.status);
                    console.log('Reply response ok:', response.ok);

                    if (response.ok) {
                        const data = await response.json();
                        console.log('Reply posted successfully:', data);
                        setComments(data.comments);
                        setDisplayedUserComments(data.comments); // Update displayed comments immediately
                        setReplyText('');
                        setReplyingTo(null);
                        showSuccess('Reply posted!');
                    } else {
                        const error = await response.json();
                        console.error('Reply error response:', error);
                        alert('Error posting reply: ' + (error.error || 'Unknown error'));
                    }
                } catch (error) {
                    console.error('=== Reply Error ===');
                    console.error('Error posting reply:', error);
                    console.error('Error stack:', error.stack);
                    alert('Network error. Please check your connection and try again.');
                }

                setIsSubmitting(false);
            };

            // Like/unlike comment or reply
            const handleLike = async (commentId, replyId = null) => {
                console.log('=== Liking Comment/Reply ===');
                console.log('Comment ID:', commentId);
                console.log('Comment ID type:', typeof commentId);
                console.log('Reply ID:', replyId);
                console.log('Reply ID type:', typeof replyId);
                console.log('Article ID:', article.id);
                console.log('Current comments in state:', comments.length);
                console.log('All comment IDs in state:', comments.map(c => ({ id: c.id, type: c.type })));

                if (!user) {
                    console.log('User not logged in for like');
                    alert('Please log in to like comments');
                    return;
                }

                try {
                    const currentUser = netlifyIdentity.currentUser();
                    const token = currentUser?.token?.access_token;

                    console.log('User email:', currentUser?.email);
                    console.log('Token present:', !!token);

                    if (!token) {
                        console.error('No token available for like');
                        alert('Authentication error. Please try logging out and back in.');
                        return;
                    }

                    const requestBody = {
                        articleId: article.id,
                        commentId: commentId,
                        replyId: replyId
                    };

                    console.log('Making like request to:', '/.netlify/functions/article-comments');
                    console.log('Request body with action:', { ...requestBody, action: 'like' });

                    const response = await fetch('/.netlify/functions/article-comments', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({
                            ...requestBody,
                            action: 'like'
                        })
                    });

                    console.log('Like response status:', response.status);
                    console.log('Like response ok:', response.ok);

                    if (response.ok) {
                        const data = await response.json();
                        console.log('Like successful:', data);
                        setComments(data.comments);
                        setDisplayedUserComments(data.comments); // Update displayed comments immediately
                    } else {
                        const error = await response.json();
                        console.error('Like error response:', error);
                        console.error('Requested ID:', error.requestedId);
                        console.error('Available IDs:', error.availableIds);
                        console.error('Total comments:', error.totalComments);
                        alert('Error liking comment: ' + error.error +
                              '\n\nRequested ID: ' + error.requestedId +
                              '\nAvailable IDs: ' + (error.availableIds || []).join(', ') +
                              '\nTotal comments: ' + error.totalComments +
                              '\n\nCheck console for full details.');
                    }
                } catch (error) {
                    console.error('=== Like Error ===');
                    console.error('Error liking:', error);
                    console.error('Error stack:', error.stack);
                    alert('Network error. Please try again.');
                }
            };

            // Delete comment or reply
            const handleDelete = async (commentId, replyId = null) => {
                if (!isAdmin) return;

                if (!confirm('Are you sure you want to delete this ' + (replyId ? 'reply' : 'comment') + '?')) {
                    return;
                }

                try {
                    const currentUser = netlifyIdentity.currentUser();
                    const token = currentUser?.token?.access_token;

                    if (!token) {
                        alert('Authentication error.');
                        return;
                    }

                    const response = await fetch('/.netlify/functions/article-comments', {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({
                            articleId: article.id,
                            commentId: commentId,
                            replyId: replyId
                        })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        setComments(data.comments);
                        setDisplayedUserComments(data.comments); // Update displayed comments immediately
                        showSuccess('Deleted successfully');
                    } else {
                        const error = await response.json();
                        alert('Error: ' + (error.error || 'Unknown error'));
                    }
                } catch (error) {
                    console.error('Error deleting:', error);
                }
            };

            // Show success notification
            const showSuccess = (message) => {
                const successMsg = document.createElement('div');
                successMsg.textContent = '✓ ' + message;
                successMsg.className = 'fixed top-20 right-4 bg-green-600 text-white px-4 py-2 rounded shadow-lg z-50';
                document.body.appendChild(successMsg);
                setTimeout(() => successMsg.remove(), 3000);
            };

            // Check if user has liked a comment/reply
            const hasLiked = (likes) => {
                return user && likes.includes(user.email);
            };

            const relatedArticles = articles.filter(a => 
                a.id !== article.id && a.category === article.category
            ).slice(0, 3);

            return (
                <div className={`min-h-screen transition-colors duration-200 ${darkMode ? 'bg-black text-gray-100' : 'bg-white text-gray-900'}`}>
                    {/* Header */}
                    <header className={`sticky top-0 z-50 border-b ${darkMode ? 'bg-black/98 backdrop-blur-xl border-gray-900' : 'bg-white/98 backdrop-blur-xl border-gray-200'}`}>
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex items-center justify-between h-16">
                                <div className="flex items-center space-x-8">
                                    <button 
                                        onClick={onBack}
                                        className={`flex items-center space-x-2 ${darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-gray-900'} transition-colors`}
                                    >
                                        <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                                        </svg>
                                        <span className="font-medium text-sm">Back</span>
                                    </button>
                                    <h1 className={`text-2xl font-serif font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                        OnPoint Articles
                                    </h1>
                                </div>
                                
                                <button 
                                    onClick={() => setDarkMode(!darkMode)}
                                    className={`p-2 transition-colors ${darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-gray-900'}`}
                                    aria-label="Toggle dark mode"
                                >
                                    {darkMode ? (
                                        <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                                        </svg>
                                    ) : (
                                        <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                                        </svg>
                                    )}
                                </button>
                            </div>
                        </div>
                    </header>

                    {/* Article Content */}
                    <article className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                        {/* Article Header */}
                        <div className="mb-8">
                            <div className="flex items-center space-x-3 mb-6">
                                <span className={`text-xs font-semibold uppercase tracking-wider ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                    {article.category}
                                </span>
                                {article.breaking && (
                                    <>
                                        <span className={`${darkMode ? 'text-gray-600' : 'text-gray-400'}`}>•</span>
                                        <span className="text-xs font-bold uppercase tracking-wider text-red-600">Breaking News</span>
                                    </>
                                )}
                            </div>
                            
                            <h1 className="text-5xl md:text-6xl font-serif font-black mb-6 leading-[0.95]">
                                LESTER TELLEZ CHARGED
                            </h1>
                            
                            <p className={`text-xl md:text-2xl mb-8 leading-relaxed ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                Former UCF student body presidential candidate and creator of Five Nights at Freddy's fan game 'Grizzly's' arrested on FIU campus for battery on persons with disabilities. Trial set for December 8.
                            </p>
                            
                            <div className={`flex items-center space-x-6 pb-8 border-b ${darkMode ? 'border-gray-900' : 'border-gray-200'}`}>
                                <div className="flex items-center space-x-3">
                                    <div className={`w-12 h-12 flex items-center justify-center text-xs font-bold ${darkMode ? 'bg-white text-black' : 'bg-black text-white'}`}>
                                        OPT
                                    </div>
                                    <div>
                                        <div className="font-semibold">{article.author}</div>
                                        <div className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>
                                            {article.date} • {article.readTime}
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="flex-1"></div>

                                <div className="flex items-center space-x-2">
                                    {user && (
                                        <button
                                            onClick={() => toggleSaveArticle(article.id)}
                                            className={`p-2 transition-colors ${darkMode ? 'hover:bg-zinc-900' : 'hover:bg-gray-100'}`}
                                            aria-label={savedArticles.includes(article.id) ? "Remove bookmark" : "Bookmark"}
                                        >
                                            <svg className="w-5 h-5" fill={savedArticles.includes(article.id) ? "currentColor" : "none"} viewBox="0 0 24 24" stroke="currentColor">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
                                            </svg>
                                        </button>
                                    )}
                                    <button className={`p-2 transition-colors ${darkMode ? 'hover:bg-zinc-900' : 'hover:bg-gray-100'}`} aria-label="Share">
                                        <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* Featured Image */}
                        <div className="mb-12">
                            <div className={`border ${darkMode ? 'border-gray-900' : 'border-gray-200'} mb-3`}>
                                <img 
                                    src={article.image} 
                                    alt={article.title}
                                    className="w-full h-auto"
                                />
                            </div>
                            <p className={`text-sm leading-relaxed ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                Florida International University campus, where Lester Tellez was arrested by FIU Campus Police on October 9, 2025. Photo: Unsplash
                            </p>
                        </div>

                        {/* What You Must Know - Pinned Section */}
                        <div className={`mb-12 relative ${darkMode ? 'bg-zinc-950 border-2 border-gray-900' : 'bg-gray-50 border-2 border-gray-200'}`}>
                            {/* Pin Icon */}
                            <div className="absolute -top-3 left-6">
                                <div className={`px-3 py-1 flex items-center space-x-2 ${darkMode ? 'bg-black border border-gray-800' : 'bg-white border border-gray-300'}`}>
                                    <svg className={`w-4 h-4 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`} fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M10 2a1 1 0 011 1v1.323l3.954 1.582a1 1 0 01.588.882V8.5a1 1 0 01-.293.707l-1.414 1.414a1 1 0 00-.293.707V13a1 1 0 01-1 1h-2v3a1 1 0 11-2 0v-3H6a1 1 0 01-1-1v-1.772a1 1 0 00-.293-.707L3.293 9.207A1 1 0 013 8.5V6.788a1 1 0 01.588-.882L7.542 4.323V3a1 1 0 011-1h1.458z" />
                                    </svg>
                                    <span className={`text-xs font-bold uppercase tracking-wider ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Pinned</span>
                                </div>
                            </div>
                            
                            <div className="pt-8 pb-6 px-8">
                                <h3 className={`text-lg font-serif font-bold mb-5 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                    What You Must Know
                                </h3>
                                
                                <p className={`text-base leading-relaxed ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                    Lester Gabriel Tellez, a 20-year-old former University of Central Florida student body presidential candidate and creator of the Five Nights at Freddy's fan game "Grizzly's," was arrested on October 9, 2025, by Florida International University Campus Police while trespassing on FIU campus. He faces two third-degree felony counts of battery on persons with mental or physical disabilities under Florida Statute § 784.085. Tellez was released on $5,000 bond and is scheduled for trial on December 8, 2025, before Judge Andrea Ricker Wolfson in Miami-Dade County Circuit Court. Sources close to the case indicate that Tellez is expected to enter a plea of "Not Guilty" at his upcoming arraignment. If convicted on both charges, he could face up to ten years in prison and $10,000 in fines.
                                </p>
                            </div>
                        </div>

                        {/* Live Updates Section */}
                        {article.liveUpdates && (
                            <div className={`mb-12 border-2 ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-gray-50 border-gray-200'}`}>
                                <div className={`px-6 py-5 border-b ${darkMode ? 'border-gray-900 bg-black' : 'border-gray-200 bg-white'}`}>
                                    <div className="flex items-center justify-between">
                                        <div className="flex items-center space-x-3">
                                            <span className="live-indicator w-2.5 h-2.5 bg-red-600 rounded-full"></span>
                                            <h2 className="text-sm font-bold uppercase tracking-widest text-red-600">Live Coverage</h2>
                                        </div>
                                        <div className="flex items-center space-x-3">
                                            <span className={`text-xs uppercase tracking-wider font-bold ${darkMode ? 'text-gray-600' : 'text-gray-400'}`}>Latest</span>
                                            <span className={`text-sm font-bold ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                {article.liveUpdates[0].time}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    {article.liveUpdates.map((update, index) => (
                                        <div 
                                            key={index} 
                                            className={`border-b ${darkMode ? 'border-gray-900 hover:bg-black' : 'border-gray-200 hover:bg-white'} transition-colors`}
                                        >
                                            <div className="px-6 py-5">
                                                <div className="flex items-start space-x-6">
                                                    <div className="flex-shrink-0 w-16">
                                                        <div className={`text-base font-bold ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                            {update.time}
                                                        </div>
                                                    </div>
                                                    <div className="flex-1">
                                                        <div className="flex items-start space-x-3">
                                                            <div className={`w-2 h-2 rounded-full mt-2 flex-shrink-0 ${index === 0 ? 'bg-red-600' : darkMode ? 'bg-gray-800' : 'bg-gray-300'}`}></div>
                                                            <p className={`text-base leading-relaxed ${darkMode ? 'text-gray-200' : 'text-gray-900'}`}>
                                                                {update.text}
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                                <div className={`px-6 py-4 ${darkMode ? 'bg-black' : 'bg-white'}`}>
                                    <p className={`text-xs ${darkMode ? 'text-gray-600' : 'text-gray-500'}`}>
                                        This is a developing story. Updates will continue as new information becomes available.
                                    </p>
                                </div>
                            </div>
                        )}

                        {/* Article Body - With Login Wall Overlay for Non-Authenticated Users */}
                        <div className={`prose max-w-none relative ${!user ? 'max-h-[600px] overflow-hidden' : ''}`}>
                            <p className={`text-xl leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                Lester Gabriel Tellez, a 20-year-old former University of Central Florida student body presidential candidate and indie game developer, was arrested on October 9, 2025, by Florida International University Campus Police on the FIU campus in Miami-Dade County, Florida. Authorities charged him with two third-degree felony counts of battery on persons with mental or physical disabilities under Florida Statute § 784.085. He was released shortly after booking on a $5,000 bond.
                            </p>

                            <p className={`text-lg leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                Tellez, born November 15, 2004, had built a notable presence across multiple communities. He gained recognition within gaming circles as the creator of "Grizzly's," an independently developed horror game inspired by Scott Cawthon's Five Nights at Freddy's franchise. Beyond gaming, he operated "On Point Politics," a YouTube channel focused on conservative political commentary. Prior to his arrest, Tellez and his associates had been banned from FIU campus, events, and activities due to ongoing political disputes and behavioral violations.
                            </p>

                            <h2 className={`text-3xl font-serif font-bold mt-12 mb-6 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                The Arrest and Charges
                            </h2>

                            {/* Mugshot */}
                            <div className="mb-8">
                                <div className={`border ${darkMode ? 'border-gray-900' : 'border-gray-200'} mb-3`}>
                                    <img
                                        src="68ed1d98a7099.webp"
                                        alt="Lester Tellez booking photo"
                                        className="w-full max-w-md mx-auto h-auto"
                                    />
                                </div>
                                <p className={`text-sm leading-relaxed ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                    Lester Gabriel Tellez booking photo from Turner Guilford Knight Correctional Center, October 9, 2025. Photo: Miami-Dade Corrections
                                </p>
                            </div>

                            <p className={`text-lg leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                The incident occurred on FIU campus property, where Tellez was trespassing in violation of his prior campus ban. According to arrest records, he faces two counts under Florida Statute § 784.085, which addresses battery on persons with mental or physical disabilities. Each count involves the intentional touching or striking of a victim known to have a mental or physical disability, causing bodily harm or apprehension of harm.
                            </p>
                            
                            <p className={`text-lg leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                The statute recognizes the particularly vulnerable nature of victims with disabilities and provides for enhanced penalties. At the time of booking at Turner Guilford Knight Correctional Center, Tellez was recorded as 5'11" tall, weighing 208 pounds, with brown hair and brown eyes. Each count carries maximum penalties of up to five years in Florida State Prison, a $5,000 fine, and up to five years of probation. If convicted on both counts with consecutive sentencing, Tellez could face up to ten years imprisonment and $10,000 in total fines.
                            </p>
                            
                            <h2 className={`text-3xl font-serif font-bold mt-12 mb-6 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                Court Proceedings
                            </h2>
                            
                            <p className={`text-lg leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                The case, filed on October 10, 2025, has been assigned Case Number F25-022112 in Miami-Dade County Circuit Court, Felony Division 13. Judge Andrea Ricker Wolfson has been assigned to oversee the proceedings. The trial is scheduled for December 8, 2025. As of October 13, 2025, no plea has been entered, and the case remains in the discovery phase.
                            </p>
                            
                            <p className={`text-lg leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                Court records are publicly accessible via the Miami-Dade Clerk of Courts online portal, where the public can search by case number or name. No motions, pleas, or discovery filings have been publicly recorded yet. The case status remains open and active, with arraignment and pretrial hearings expected to occur in accordance with standard criminal procedure timelines.
                            </p>
                            
                            <h2 className={`text-3xl font-serif font-bold mt-12 mb-6 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                Background and Prior Controversies
                            </h2>
                            
                            <p className={`text-lg leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                Prior to this arrest, Tellez had no criminal record in Miami-Dade County. However, he had accumulated a history of university sanctions and campus bans. Most notably, he was disqualified from the University of Central Florida's 2025 student body presidential election for bribery and rule violations. He subsequently faced bans from multiple Florida campuses, including FIU, for harassment and disruptive behavior related to his political activities.
                            </p>
                            
                            <p className={`text-lg leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                His work on "Grizzly's" had garnered a devoted following within the Five Nights at Freddy's fan game community. The game featured distinctive VHS-style cutscenes and received critical attention, leading to the development of multiple follow-up projects, including a virtual reality adaptation. Through "On Point Politics," Tellez maintained a presence in conservative commentary circles, operating the channel under the business entity On Point Politics LLC.
                            </p>
                            
                            <h2 className={`text-3xl font-serif font-bold mt-12 mb-6 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                Immediate Aftermath
                            </h2>
                            
                            <p className={`text-lg leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                News of Tellez's arrest spread rapidly through online gaming communities. Shortly after the arrest became public, GameJolt banned his account, effectively removing access to "Grizzly's," "Grizzly's 2," "Grizzly's VR," and various other projects he had hosted on the platform. The removal came without public statement from GameJolt, though such actions typically align with platform terms of service regarding users facing serious criminal charges.
                            </p>
                            
                            <p className={`text-lg leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                The status of his ongoing development projects and "On Point Politics" media operations remains uncertain. Collaborators who had worked with Tellez on various projects have not issued public statements regarding the charges or the future of their collaborative work. The case has generated significant discussion across social media platforms, particularly within the Five Nights at Freddy's fan game community and political commentary circles where Tellez maintained his presence.
                            </p>
                            
                            <h2 className={`text-3xl font-serif font-bold mt-12 mb-6 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                Looking Ahead
                            </h2>
                            
                            <p className={`text-lg leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                With trial scheduled for December 8, 2025, the case will proceed through the Florida criminal justice system. Tellez is presumed innocent until proven guilty. Details surrounding the specific circumstances of the alleged incidents remain limited due to the ongoing nature of the investigation and sealed portions of the court record. Neither Tellez nor his legal representation have issued public statements regarding the charges.
                            </p>
                            
                            <p className={`text-lg leading-relaxed mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-800'}`}>
                                This is a developing story. Additional information will be provided as it becomes available through official court proceedings and public records. Anyone with information relevant to this case is encouraged to contact the FIU Police Department or the Miami-Dade County State Attorney's Office.
                            </p>

                            {/* Fixed Login Wall Overlay - Only for Non-Authenticated Users */}
                            {!user && (
                                <>
                                    {/* Blur Overlay on Content */}
                                    <div className="fixed inset-0 pointer-events-none" style={{backdropFilter: 'blur(0px)'}}></div>

                                    {/* Fixed Bottom Login Wall */}
                                    <div className="fixed bottom-0 left-0 right-0 z-50">
                                        {/* Gradient Fade */}
                                        <div className={`h-48 ${darkMode ? 'bg-gradient-to-t from-black via-black/95 to-transparent' : 'bg-gradient-to-t from-white via-white/95 to-transparent'}`}></div>

                                        {/* Login Wall Content */}
                                        <div className={`${darkMode ? 'bg-black border-t-2 border-gray-900' : 'bg-white border-t-2 border-gray-300'} pb-safe`}>
                                            <div className="max-w-4xl mx-auto px-6 md:px-12 py-8">
                                                <div className="flex flex-col md:flex-row items-center justify-between gap-6">
                                                    {/* Left side - Message */}
                                                    <div className="flex-1 text-center md:text-left">
                                                        <div className="flex items-center justify-center md:justify-start space-x-3 mb-3">
                                                            <svg className={`w-6 h-6 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`} fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                                            </svg>
                                                            <h3 className={`text-xl md:text-2xl font-serif font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                                Continue Reading
                                                            </h3>
                                                        </div>
                                                        <p className={`text-sm md:text-base ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                            Sign in or create a free account to access the full article
                                                        </p>
                                                    </div>

                                                    {/* Right side - Buttons */}
                                                    <div className="flex items-center space-x-3">
                                                        <button
                                                            onClick={() => openAuthModal('signin')}
                                                            className={`px-6 py-3 text-sm font-semibold transition-all border-2 ${darkMode ? 'border-gray-800 text-white hover:bg-zinc-900' : 'border-gray-300 text-gray-900 hover:bg-gray-50'}`}
                                                        >
                                                            Sign In
                                                        </button>
                                                        <button
                                                            onClick={() => openAuthModal('signup')}
                                                            className={`px-6 py-3 text-sm font-semibold transition-all ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}
                                                        >
                                                            Create Account
                                                        </button>
                                                    </div>
                                                </div>

                                                {/* Benefits */}
                                                <div className={`mt-6 pt-4 border-t ${darkMode ? 'border-gray-900' : 'border-gray-200'}`}>
                                                    <div className="flex items-center justify-center md:justify-start space-x-6 text-xs">
                                                        <div className="flex items-center space-x-1.5">
                                                            <svg className={`w-3.5 h-3.5 ${darkMode ? 'text-gray-600' : 'text-gray-400'}`} fill="currentColor" viewBox="0 0 20 20">
                                                                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                                            </svg>
                                                            <span className={darkMode ? 'text-gray-500' : 'text-gray-600'}>Free forever</span>
                                                        </div>
                                                        <div className="flex items-center space-x-1.5">
                                                            <svg className={`w-3.5 h-3.5 ${darkMode ? 'text-gray-600' : 'text-gray-400'}`} fill="currentColor" viewBox="0 0 20 20">
                                                                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                                            </svg>
                                                            <span className={darkMode ? 'text-gray-500' : 'text-gray-600'}>No credit card</span>
                                                        </div>
                                                        <div className="flex items-center space-x-1.5">
                                                            <svg className={`w-3.5 h-3.5 ${darkMode ? 'text-gray-600' : 'text-gray-400'}`} fill="currentColor" viewBox="0 0 20 20">
                                                                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                                            </svg>
                                                            <span className={darkMode ? 'text-gray-500' : 'text-gray-600'}>Cancel anytime</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </>
                            )}
                        </div>

                        {/* Tags - Only for Logged In Users */}
                        {user && (
                            <div className={`mt-12 pt-8 border-t ${darkMode ? 'border-gray-900' : 'border-gray-200'}`}>
                                <div className="flex flex-wrap gap-2">
                                    {["Legal", "Gaming", "FNAF", "On Point Politics", "Miami-Dade", "Breaking News"].map(tag => (
                                        <span key={tag} className={`px-3 py-1.5 text-xs font-medium ${darkMode ? 'bg-zinc-900 text-gray-400' : 'bg-gray-100 text-gray-700'}`}>
                                            {tag}
                                        </span>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Admin Content Edit Button */}
                        {isAdmin && user && (
                            <div className="mt-8 flex justify-end">
                                <button
                                    onClick={() => setShowEditModal(true)}
                                    className={`px-4 py-2 text-sm font-semibold transition-all ${darkMode ? 'bg-blue-900 text-white hover:bg-blue-800 border border-blue-800' : 'bg-blue-50 text-blue-900 hover:bg-blue-100 border border-blue-200'}`}
                                >
                                    ✏️ Edit Article Content
                                </button>
                            </div>
                        )}

                        {/* Comments Sections - Only for Logged In Users */}
                        {user && (
                            <>
                        {/* Reporter Comments Section */}
                        <div className={`mt-12 pt-12 border-t-2 ${darkMode ? 'border-gray-900' : 'border-gray-200'}`}>
                            <div className="max-w-3xl">
                                <div className="flex items-center justify-between mb-8">
                                    <div className="flex items-center space-x-3">
                                        <h3 className={`text-xl font-serif font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                            Reporter Comments
                                        </h3>
                                        <span className="live-indicator w-1.5 h-1.5 bg-red-600 rounded-full"></span>
                                        <span className="text-xs font-bold uppercase tracking-wider text-red-600">Live</span>
                                    </div>
                                    <span className={`text-sm ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                        {comments.filter(c => c.type === 'reporter').length} comments
                                    </span>
                                </div>

                                {/* Admin Reporter Comment Form */}
                                {isAdmin && (
                                    <div className={`mb-8 border-2 ${darkMode ? 'bg-zinc-950 border-blue-900' : 'bg-blue-50 border-blue-200'}`}>
                                        <div className="p-6">
                                            <div className="flex items-center space-x-2 mb-4">
                                                <svg className="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                                    <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z" clipRule="evenodd" />
                                                </svg>
                                                <span className="text-sm font-bold text-blue-600">Admin Mode - Reporter Comment</span>
                                            </div>
                                            <form onSubmit={(e) => { setCommentType('reporter'); handleSubmitComment(e); }}>
                                                <textarea
                                                    value={commentText}
                                                    onChange={(e) => setCommentText(e.target.value)}
                                                    placeholder="Add a reporter comment... (HTML is supported)"
                                                    className={`w-full px-4 py-3 text-base border resize-vertical min-h-[120px] focus:outline-none ${darkMode ? 'bg-black border-gray-800 text-white placeholder-gray-600' : 'bg-white border-gray-300 text-gray-900 placeholder-gray-400'}`}
                                                    disabled={isSubmitting}
                                                />
                                                <div className="mt-3 flex items-center justify-between">
                                                    <span className={`text-xs ${darkMode ? 'text-gray-500' : 'text-gray-600'}`}>
                                                        Tip: Use &lt;span class='font-bold'&gt;UPDATE:&lt;/span&gt; to highlight
                                                    </span>
                                                    <button
                                                        type="submit"
                                                        disabled={isSubmitting || !commentText.trim()}
                                                        className={`px-6 py-2 text-sm font-semibold transition-all ${isSubmitting || !commentText.trim() ? 'opacity-50 cursor-not-allowed' : ''} ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}
                                                    >
                                                        {isSubmitting ? 'Posting...' : 'Post Reporter Comment'}
                                                    </button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                )}

                                {comments.filter(c => c.type === 'reporter').length === 0 ? (
                                    <div className={`border ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-white border-gray-200'} p-8 text-center`}>
                                        <p className={`text-sm ${darkMode ? 'text-gray-500' : 'text-gray-600'}`}>
                                            No reporter comments yet. Check back for updates.
                                        </p>
                                    </div>
                                ) : (
                                    comments.filter(c => c.type === 'reporter').map((comment) => (
                                        <div key={comment.id} className={`mb-6 border ${darkMode ? 'border-gray-900 bg-zinc-950' : 'border-gray-200 bg-white'}`}>
                                            <div className="p-6">
                                                <div className="flex items-start space-x-4">
                                                    <div className={`w-10 h-10 flex items-center justify-center text-sm font-bold flex-shrink-0 ${darkMode ? 'bg-white text-black' : 'bg-black text-white'}`}>
                                                        {comment.author.name.charAt(0).toUpperCase()}
                                                    </div>
                                                    <div className="flex-1">
                                                        <div className="flex items-center justify-between mb-2">
                                                            <div className="flex items-center space-x-2">
                                                                <span className={`font-bold text-sm ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                                    {comment.author.name}
                                                                </span>
                                                                <span className={`px-2 py-0.5 text-xs font-bold ${darkMode ? 'bg-blue-900 text-blue-200' : 'bg-blue-100 text-blue-800'}`}>
                                                                    REPORTER
                                                                </span>
                                                                <span className={`text-xs ${darkMode ? 'text-gray-600' : 'text-gray-400'}`}>•</span>
                                                                <span className={`text-xs ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                                    {getRelativeTime(comment.timestamp)}
                                                                </span>
                                                            </div>
                                                            {isAdmin && (
                                                                <button
                                                                    onClick={() => handleDelete(comment.id)}
                                                                    className={`p-1 transition-colors ${darkMode ? 'text-gray-600 hover:text-red-400' : 'text-gray-400 hover:text-red-600'}`}
                                                                    title="Delete comment"
                                                                >
                                                                    <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                                                    </svg>
                                                                </button>
                                                            )}
                                                        </div>
                                                        <p className={`text-base leading-relaxed mb-3 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`} dangerouslySetInnerHTML={{ __html: comment.text }}></p>

                                                        {/* Like and Reply buttons */}
                                                        <div className="flex items-center space-x-4">
                                                            <button
                                                                onClick={() => handleLike(comment.id)}
                                                                className={`flex items-center space-x-1 text-xs font-medium transition-colors ${hasLiked(comment.likes) ? 'text-blue-600' : darkMode ? 'text-gray-500 hover:text-gray-300' : 'text-gray-600 hover:text-gray-900'}`}
                                                            >
                                                                <svg className="w-4 h-4" fill={hasLiked(comment.likes) ? 'currentColor' : 'none'} viewBox="0 0 24 24" stroke="currentColor">
                                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5" />
                                                                </svg>
                                                                <span>{comment.likes.length > 0 ? comment.likes.length : ''}</span>
                                                            </button>
                                                            <button
                                                                onClick={() => setReplyingTo(replyingTo === comment.id ? null : comment.id)}
                                                                className={`flex items-center space-x-1 text-xs font-medium transition-colors ${darkMode ? 'text-gray-500 hover:text-gray-300' : 'text-gray-600 hover:text-gray-900'}`}
                                                            >
                                                                <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6" />
                                                                </svg>
                                                                <span>Reply</span>
                                                            </button>
                                                        </div>

                                                        {/* Reply Form */}
                                                        {replyingTo === comment.id && (
                                                            <div className={`mt-4 border-l-2 ${darkMode ? 'border-gray-800' : 'border-gray-300'} pl-4`}>
                                                                <textarea
                                                                    value={replyText}
                                                                    onChange={(e) => setReplyText(e.target.value)}
                                                                    placeholder="Write a reply..."
                                                                    className={`w-full px-3 py-2 text-sm border resize-vertical min-h-[80px] focus:outline-none ${darkMode ? 'bg-black border-gray-800 text-white placeholder-gray-600' : 'bg-white border-gray-300 text-gray-900 placeholder-gray-400'}`}
                                                                    disabled={isSubmitting}
                                                                />
                                                                <div className="mt-2 flex items-center space-x-2">
                                                                    <button
                                                                        onClick={() => handleSubmitReply(comment.id)}
                                                                        disabled={isSubmitting || !replyText.trim()}
                                                                        className={`px-4 py-1.5 text-xs font-semibold transition-all ${isSubmitting || !replyText.trim() ? 'opacity-50 cursor-not-allowed' : ''} ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}
                                                                    >
                                                                        {isSubmitting ? 'Posting...' : 'Post Reply'}
                                                                    </button>
                                                                    <button
                                                                        onClick={() => { setReplyingTo(null); setReplyText(''); }}
                                                                        className={`px-4 py-1.5 text-xs font-medium transition-colors ${darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-gray-900'}`}
                                                                    >
                                                                        Cancel
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        )}

                                                        {/* Replies */}
                                                        {comment.replies && comment.replies.length > 0 && (
                                                            <div className={`mt-4 space-y-4 border-l-2 ${darkMode ? 'border-gray-800' : 'border-gray-300'} pl-4`}>
                                                                {comment.replies.map((reply) => (
                                                                    <div key={reply.id} className="flex items-start space-x-3">
                                                                        <div className={`w-8 h-8 flex items-center justify-center text-xs font-bold flex-shrink-0 ${darkMode ? 'bg-gray-800 text-white' : 'bg-gray-200 text-gray-900'}`}>
                                                                            {reply.author.name.charAt(0).toUpperCase()}
                                                                        </div>
                                                                        <div className="flex-1">
                                                                            <div className="flex items-center justify-between mb-1">
                                                                                <div className="flex items-center space-x-2">
                                                                                    <span className={`font-bold text-xs ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                                                        {reply.author.name}
                                                                                    </span>
                                                                                    <span className={`text-xs ${darkMode ? 'text-gray-600' : 'text-gray-400'}`}>•</span>
                                                                                    <span className={`text-xs ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                                                        {getRelativeTime(reply.timestamp)}
                                                                                    </span>
                                                                                </div>
                                                                                {isAdmin && (
                                                                                    <button
                                                                                        onClick={() => handleDelete(comment.id, reply.id)}
                                                                                        className={`p-1 transition-colors ${darkMode ? 'text-gray-600 hover:text-red-400' : 'text-gray-400 hover:text-red-600'}`}
                                                                                        title="Delete reply"
                                                                                    >
                                                                                        <svg className="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                                                                        </svg>
                                                                                    </button>
                                                                                )}
                                                                            </div>
                                                                            <p className={`text-sm leading-relaxed mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                                                                {reply.text}
                                                                            </p>
                                                                            <button
                                                                                onClick={() => handleLike(comment.id, reply.id)}
                                                                                className={`flex items-center space-x-1 text-xs font-medium transition-colors ${hasLiked(reply.likes) ? 'text-blue-600' : darkMode ? 'text-gray-500 hover:text-gray-300' : 'text-gray-600 hover:text-gray-900'}`}
                                                                            >
                                                                                <svg className="w-3 h-3" fill={hasLiked(reply.likes) ? 'currentColor' : 'none'} viewBox="0 0 24 24" stroke="currentColor">
                                                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5" />
                                                                                </svg>
                                                                                <span>{reply.likes.length > 0 ? reply.likes.length : ''}</span>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                ))}
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    ))
                                )}
                            </div>
                        </div>

                        {/* Community Discussion Section */}
                        <div className={`mt-12 pt-12 border-t-2 ${darkMode ? 'border-gray-900' : 'border-gray-200'}`}>
                            <div className="max-w-3xl">
                                <div className="flex items-center justify-between mb-8">
                                    <div className="flex items-center space-x-3">
                                        <h3 className={`text-xl font-serif font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                            Community Discussion
                                        </h3>
                                    </div>
                                    <div className="flex items-center space-x-4">
                                        <button
                                            onClick={refreshUserComments}
                                            className={`flex items-center space-x-2 px-3 py-1.5 text-xs font-semibold transition-all ${darkMode ? 'bg-zinc-900 text-gray-300 hover:bg-zinc-800 border border-gray-800' : 'bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300'}`}
                                        >
                                            <svg className="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                                            </svg>
                                            <span>Refresh</span>
                                        </button>
                                        <span className={`text-sm ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                            {displayedUserComments.filter(c => c.type === 'user').length} comments
                                        </span>
                                    </div>
                                </div>

                                {/* User Comment Form */}
                                {user ? (
                                    <div className={`mb-8 border ${darkMode ? 'bg-zinc-950 border-gray-800' : 'bg-white border-gray-200'}`}>
                                        <div className="p-6">
                                            <div className="flex items-center space-x-2 mb-4">
                                                <svg className="w-4 h-4 text-gray-600" fill="currentColor" viewBox="0 0 20 20">
                                                    <path fillRule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clipRule="evenodd" />
                                                </svg>
                                                <span className={`text-sm font-medium ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                    Commenting as {user.email.split('@')[0]}
                                                </span>
                                            </div>
                                            <form onSubmit={(e) => { setCommentType('user'); handleSubmitComment(e); }}>
                                                <textarea
                                                    value={commentText}
                                                    onChange={(e) => setCommentText(e.target.value)}
                                                    placeholder="Share your thoughts on this article..."
                                                    className={`w-full px-4 py-3 text-base border resize-vertical min-h-[100px] focus:outline-none ${darkMode ? 'bg-black border-gray-800 text-white placeholder-gray-600' : 'bg-white border-gray-300 text-gray-900 placeholder-gray-400'}`}
                                                    disabled={isSubmitting}
                                                />
                                                <div className="mt-3 flex items-center justify-end">
                                                    <button
                                                        type="submit"
                                                        disabled={isSubmitting || !commentText.trim()}
                                                        className={`px-6 py-2 text-sm font-semibold transition-all ${isSubmitting || !commentText.trim() ? 'opacity-50 cursor-not-allowed' : ''} ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}
                                                    >
                                                        {isSubmitting ? 'Posting...' : 'Post Comment'}
                                                    </button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                ) : (
                                    <div className={`mb-8 border ${darkMode ? 'bg-zinc-950 border-gray-800' : 'bg-gray-50 border-gray-200'} p-8 text-center`}>
                                        <p className={`text-sm mb-4 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                            Join the conversation! Sign in to share your thoughts.
                                        </p>
                                        <button
                                            onClick={() => netlifyIdentity.open()}
                                            className={`px-6 py-2 text-sm font-semibold transition-all ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}
                                        >
                                            Sign In to Comment
                                        </button>
                                    </div>
                                )}

                                {displayedUserComments.filter(c => c.type === 'user').length === 0 ? (
                                    <div className={`border ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-white border-gray-200'} p-8 text-center`}>
                                        <p className={`text-sm ${darkMode ? 'text-gray-500' : 'text-gray-600'}`}>
                                            No comments yet. Be the first to share your thoughts!
                                        </p>
                                    </div>
                                ) : (
                                    displayedUserComments.filter(c => c.type === 'user').map((comment) => (
                                        <div key={comment.id} className={`mb-6 border ${darkMode ? 'border-gray-800 bg-zinc-950' : 'border-gray-200 bg-white'}`}>
                                            <div className="p-6">
                                                <div className="flex items-start space-x-4">
                                                    <div className={`w-10 h-10 flex items-center justify-center text-sm font-bold flex-shrink-0 rounded-full ${darkMode ? 'bg-gray-800 text-white' : 'bg-gray-200 text-gray-900'}`}>
                                                        {comment.author.name.charAt(0).toUpperCase()}
                                                    </div>
                                                    <div className="flex-1">
                                                        <div className="flex items-center justify-between mb-2">
                                                            <div className="flex items-center space-x-2">
                                                                <span className={`font-bold text-sm ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                                    {comment.author.name}
                                                                </span>
                                                                <span className={`text-xs ${darkMode ? 'text-gray-600' : 'text-gray-400'}`}>•</span>
                                                                <span className={`text-xs ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                                    {getRelativeTime(comment.timestamp)}
                                                                </span>
                                                            </div>
                                                            {isAdmin && (
                                                                <button
                                                                    onClick={() => handleDelete(comment.id)}
                                                                    className={`p-1 transition-colors ${darkMode ? 'text-gray-600 hover:text-red-400' : 'text-gray-400 hover:text-red-600'}`}
                                                                    title="Delete comment"
                                                                >
                                                                    <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                                                    </svg>
                                                                </button>
                                                            )}
                                                        </div>
                                                        <p className={`text-base leading-relaxed mb-3 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                                            {comment.text}
                                                        </p>

                                                        {/* Like and Reply buttons */}
                                                        <div className="flex items-center space-x-4">
                                                            <button
                                                                onClick={() => handleLike(comment.id)}
                                                                className={`flex items-center space-x-1 text-xs font-medium transition-colors ${hasLiked(comment.likes) ? 'text-blue-600' : darkMode ? 'text-gray-500 hover:text-gray-300' : 'text-gray-600 hover:text-gray-900'}`}
                                                            >
                                                                <svg className="w-4 h-4" fill={hasLiked(comment.likes) ? 'currentColor' : 'none'} viewBox="0 0 24 24" stroke="currentColor">
                                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5" />
                                                                </svg>
                                                                <span>{comment.likes.length > 0 ? comment.likes.length : ''}</span>
                                                            </button>
                                                            <button
                                                                onClick={() => setReplyingTo(replyingTo === comment.id ? null : comment.id)}
                                                                className={`flex items-center space-x-1 text-xs font-medium transition-colors ${darkMode ? 'text-gray-500 hover:text-gray-300' : 'text-gray-600 hover:text-gray-900'}`}
                                                            >
                                                                <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6" />
                                                                </svg>
                                                                <span>Reply</span>
                                                            </button>
                                                        </div>

                                                        {/* Reply Form */}
                                                        {replyingTo === comment.id && (
                                                            <div className={`mt-4 border-l-2 ${darkMode ? 'border-gray-800' : 'border-gray-300'} pl-4`}>
                                                                <textarea
                                                                    value={replyText}
                                                                    onChange={(e) => setReplyText(e.target.value)}
                                                                    placeholder="Write a reply..."
                                                                    className={`w-full px-3 py-2 text-sm border resize-vertical min-h-[80px] focus:outline-none ${darkMode ? 'bg-black border-gray-800 text-white placeholder-gray-600' : 'bg-white border-gray-300 text-gray-900 placeholder-gray-400'}`}
                                                                    disabled={isSubmitting}
                                                                />
                                                                <div className="mt-2 flex items-center space-x-2">
                                                                    <button
                                                                        onClick={() => handleSubmitReply(comment.id)}
                                                                        disabled={isSubmitting || !replyText.trim()}
                                                                        className={`px-4 py-1.5 text-xs font-semibold transition-all ${isSubmitting || !replyText.trim() ? 'opacity-50 cursor-not-allowed' : ''} ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}
                                                                    >
                                                                        {isSubmitting ? 'Posting...' : 'Post Reply'}
                                                                    </button>
                                                                    <button
                                                                        onClick={() => { setReplyingTo(null); setReplyText(''); }}
                                                                        className={`px-4 py-1.5 text-xs font-medium transition-colors ${darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-gray-900'}`}
                                                                    >
                                                                        Cancel
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        )}

                                                        {/* Replies */}
                                                        {comment.replies && comment.replies.length > 0 && (
                                                            <div className={`mt-4 space-y-4 border-l-2 ${darkMode ? 'border-gray-800' : 'border-gray-300'} pl-4`}>
                                                                {comment.replies.map((reply) => (
                                                                    <div key={reply.id} className="flex items-start space-x-3">
                                                                        <div className={`w-8 h-8 flex items-center justify-center text-xs font-bold flex-shrink-0 rounded-full ${darkMode ? 'bg-gray-800 text-white' : 'bg-gray-200 text-gray-900'}`}>
                                                                            {reply.author.name.charAt(0).toUpperCase()}
                                                                        </div>
                                                                        <div className="flex-1">
                                                                            <div className="flex items-center justify-between mb-1">
                                                                                <div className="flex items-center space-x-2">
                                                                                    <span className={`font-bold text-xs ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                                                        {reply.author.name}
                                                                                    </span>
                                                                                    <span className={`text-xs ${darkMode ? 'text-gray-600' : 'text-gray-400'}`}>•</span>
                                                                                    <span className={`text-xs ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                                                        {getRelativeTime(reply.timestamp)}
                                                                                    </span>
                                                                                </div>
                                                                                {isAdmin && (
                                                                                    <button
                                                                                        onClick={() => handleDelete(comment.id, reply.id)}
                                                                                        className={`p-1 transition-colors ${darkMode ? 'text-gray-600 hover:text-red-400' : 'text-gray-400 hover:text-red-600'}`}
                                                                                        title="Delete reply"
                                                                                    >
                                                                                        <svg className="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                                                                        </svg>
                                                                                    </button>
                                                                                )}
                                                                            </div>
                                                                            <p className={`text-sm leading-relaxed mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                                                                {reply.text}
                                                                            </p>
                                                                            <button
                                                                                onClick={() => handleLike(comment.id, reply.id)}
                                                                                className={`flex items-center space-x-1 text-xs font-medium transition-colors ${hasLiked(reply.likes) ? 'text-blue-600' : darkMode ? 'text-gray-500 hover:text-gray-300' : 'text-gray-600 hover:text-gray-900'}`}
                                                                            >
                                                                                <svg className="w-3 h-3" fill={hasLiked(reply.likes) ? 'currentColor' : 'none'} viewBox="0 0 24 24" stroke="currentColor">
                                                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5" />
                                                                                </svg>
                                                                                <span>{reply.likes.length > 0 ? reply.likes.length : ''}</span>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                ))}
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    ))
                                )}

                                {/* Contact Footer */}
                                <div className={`mt-8 pt-6 border-t ${darkMode ? 'border-gray-900' : 'border-gray-200'}`}>
                                    <p className={`text-sm ${darkMode ? 'text-gray-500' : 'text-gray-600'}`}>
                                        Have information about this story? Contact {article.author} at{' '}
                                        <a href="mailto:tips@onpointarticles.com" className={`font-medium ${darkMode ? 'text-white hover:underline' : 'text-black hover:underline'}`}>
                                            tips@onpointarticles.com
                                        </a>
                                    </p>
                                </div>
                            </div>
                        </div>
                            </>
                        )}
                    </article>

                    {/* Related Articles */}
                    {relatedArticles.length > 0 && (
                        <section className={`border-t ${darkMode ? 'bg-zinc-950 border-gray-900' : 'bg-gray-50 border-gray-200'}`}>
                            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                                <h2 className="text-2xl font-serif font-bold mb-8">Related Stories</h2>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    {relatedArticles.map(relatedArticle => (
                                        <article
                                            key={relatedArticle.id}
                                            onClick={() => {
                                                window.scrollTo(0, 0);
                                                setSelectedArticle(relatedArticle);
                                            }}
                                            className={`overflow-hidden cursor-pointer group article-card ${darkMode ? 'bg-black border border-gray-900' : 'bg-white border border-gray-200'}`}
                                        >
                                            <div className="aspect-[16/9] relative overflow-hidden">
                                                <img
                                                    src={relatedArticle.image}
                                                    alt={relatedArticle.title}
                                                    className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                                                />
                                            </div>
                                            <div className="p-5">
                                                <span className={`text-xs font-semibold uppercase tracking-wider ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                    {relatedArticle.category}
                                                </span>
                                                <h3 className={`text-lg font-serif font-bold mt-3 mb-2 leading-tight ${darkMode ? 'group-hover:text-gray-300' : 'group-hover:text-gray-600'} transition-colors`}>
                                                    {relatedArticle.title}
                                                </h3>
                                                <div className={`flex items-center space-x-2 text-xs ${darkMode ? 'text-gray-500' : 'text-gray-500'}`}>
                                                    <span>{relatedArticle.author}</span>
                                                    <span>•</span>
                                                    <span>{relatedArticle.readTime}</span>
                                                </div>
                                            </div>
                                        </article>
                                    ))}
                                </div>
                            </div>
                        </section>
                    )}

                    {/* Admin Content Edit Modal */}
                    {showEditModal && (
                        <div className="fixed inset-0 z-50 overflow-y-auto">
                            <div className="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
                                {/* Background overlay */}
                                <div
                                    className="fixed inset-0 transition-opacity bg-black bg-opacity-75"
                                    onClick={() => setShowEditModal(false)}
                                ></div>

                                {/* Modal panel */}
                                <div className={`inline-block align-bottom text-left overflow-hidden transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full ${darkMode ? 'bg-black border-2 border-gray-800' : 'bg-white border-2 border-gray-300'}`}>
                                    <div className={`px-6 py-5 border-b ${darkMode ? 'border-gray-800' : 'border-gray-300'}`}>
                                        <div className="flex items-center justify-between">
                                            <h3 className={`text-xl font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                                                Edit Article Content
                                            </h3>
                                            <button
                                                onClick={() => setShowEditModal(false)}
                                                className={`transition-colors ${darkMode ? 'text-gray-500 hover:text-white' : 'text-gray-400 hover:text-gray-900'}`}
                                            >
                                                <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                                </svg>
                                            </button>
                                        </div>
                                    </div>

                                    <div className="px-6 py-6 max-h-[70vh] overflow-y-auto">
                                        <div className="space-y-6">
                                            {/* Article Title */}
                                            <div>
                                                <label className={`block text-sm font-bold mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                                    Article Title
                                                </label>
                                                <input
                                                    type="text"
                                                    value={editArticleTitle}
                                                    onChange={(e) => setEditArticleTitle(e.target.value)}
                                                    className={`w-full px-4 py-3 text-lg font-bold border focus:outline-none ${darkMode ? 'bg-black border-gray-800 text-white' : 'bg-white border-gray-300 text-gray-900'}`}
                                                    placeholder="Article title..."
                                                />
                                            </div>

                                            {/* What You Must Know */}
                                            <div>
                                                <label className={`block text-sm font-bold mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                                    What You Must Know Section
                                                </label>
                                                <textarea
                                                    value={editWhatYouMustKnow}
                                                    onChange={(e) => setEditWhatYouMustKnow(e.target.value)}
                                                    className={`w-full px-4 py-3 text-base border resize-vertical min-h-[150px] focus:outline-none ${darkMode ? 'bg-black border-gray-800 text-white placeholder-gray-600' : 'bg-white border-gray-300 text-gray-900 placeholder-gray-400'}`}
                                                    placeholder="Key information readers must know..."
                                                />
                                            </div>

                                            {/* Article Body */}
                                            <div>
                                                <label className={`block text-sm font-bold mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                                    Article Body
                                                </label>
                                                <textarea
                                                    value={editArticleBody}
                                                    onChange={(e) => setEditArticleBody(e.target.value)}
                                                    className={`w-full px-4 py-3 text-base border resize-vertical min-h-[300px] focus:outline-none ${darkMode ? 'bg-black border-gray-800 text-white placeholder-gray-600' : 'bg-white border-gray-300 text-gray-900 placeholder-gray-400'}`}
                                                    placeholder="Full article content..."
                                                />
                                            </div>

                                            <div className={`p-4 border ${darkMode ? 'bg-zinc-950 border-gray-800' : 'bg-blue-50 border-blue-200'}`}>
                                                <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-700'}`}>
                                                    <strong>Note:</strong> This is a demo feature. Changes will be shown in a success message but won't be persisted to storage.
                                                </p>
                                            </div>
                                        </div>
                                    </div>

                                    <div className={`px-6 py-4 border-t ${darkMode ? 'border-gray-800 bg-zinc-950' : 'border-gray-300 bg-gray-50'} flex items-center justify-end space-x-3`}>
                                        <button
                                            onClick={() => setShowEditModal(false)}
                                            className={`px-6 py-2 text-sm font-medium transition-colors ${darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-gray-900'}`}
                                        >
                                            Cancel
                                        </button>
                                        <button
                                            onClick={() => {
                                                setShowEditModal(false);
                                                showSuccess('Article content updated! (Demo mode - changes not persisted)');
                                            }}
                                            className={`px-6 py-2 text-sm font-semibold transition-all ${darkMode ? 'bg-white text-black hover:bg-gray-100' : 'bg-black text-white hover:bg-gray-900'}`}
                                        >
                                            Save Changes
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>